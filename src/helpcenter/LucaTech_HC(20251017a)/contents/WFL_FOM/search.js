var searchWords = $('<div class="search"><div id="WFL11001"><div class="search_breadcrumbs">フォーム設定 &gt; はじめに</div></div><div id="WFL11004"><div class="search_breadcrumbs">フォーム設定 &gt; フォーム設定機能の概要 &gt; フォーム設定機能について</div><div class="search_title">フォーム設定機能について</div><div class="displayText">フォーム設定機能についてフォーム設定は、申請書の様式を作成する機能です。初期登録されている申請書のレイアウトの変更や、新規登録した申請書の入力フォーマットの作成ができます。フォーム ...</div><div class="search_word">フォーム設定機能についてフォーム設定は、申請書の様式を作成する機能です。初期登録されている申請書のレイアウトの変更や、新規登録した申請書の入力フォーマットの作成ができます。フォーム設定機能を使用して申請書の編集を行うことで、企業の運用に合わせた申請書の作成が可能になります。 フォーム設定は、［設定］＞［導入処理］＞［ワークフロー］＞［申請書登録］の［…］から行います。</div></div><div id="WFL11005"><div class="search_breadcrumbs">フォーム設定 &gt; フォーム設定機能の概要 &gt; 画面構成について</div><div class="search_title">画面構成について</div><div class="displayText">画面構成についてフォーム設定画面の画面構成について説明します。1申請書の表示倍率を変更します。グリッド表示グリッド線の表示・非表示を切り替えます。プレビュー申請書のプレビューを表示 ...</div><div class="search_word">画面構成についてフォーム設定画面の画面構成について説明します。1申請書の表示倍率を変更します。グリッド表示グリッド線の表示・非表示を切り替えます。プレビュー申請書のプレビューを表示します。未設定の項目がある場合は、プレビューを表示できません。2操作ツール一覧アイテムのコピー・貼り付けや、計算式に誤りがないかのチェックなど、申請書全体の設定を行います。操作ツールの各機能については次を参照してください。⇒『操作ツールの各機能について』参照3アイテム一覧申請書に追加できるアイテムの一覧が表示されます。アイテムをキャンバスにドラッグ＆ドロップして配置します。アイテムの各機能については次を参照してください。⇒『アイテムの各機能について』参照4キャンバス実際の申請書のイメージに基づき、項目の追加やレイアウトの変更などを行うエリアです。5アイテム詳細設定申請書に配置したアイテムをクリックして、フォントや項目名称などアイテムの詳細設定を行います。</div></div><div id="WFL11006"><div class="search_breadcrumbs">フォーム設定 &gt; フォーム設定機能の概要 &gt; フォーム設定を行う</div><div class="search_title">フォーム設定を行う</div><div class="displayText">フォーム設定を行うフォーム設定の基本的な操作手順は次のとおりです。①　フォーム設定を行う申請書の［…］をクリックして［フォーム設定］を選択します。フォーム設定画面が表示されます。② ...</div><div class="search_word">フォーム設定を行うフォーム設定の基本的な操作手順は次のとおりです。①　フォーム設定を行う申請書の［…］をクリックして［フォーム設定］を選択します。フォーム設定画面が表示されます。②　画面左のアイテム一覧から、申請書に追加したいアイテムをドラック＆ドロップで配置します。アイテムの位置やサイズは自由に変更できます。③　申請書に追加したアイテムをクリックすると右側に設定画面が表示されるので、文字のサイズや項目名称の変更など、アイテムの詳細設定を行います。設定項目はアイテムによって異なります。アイテムごとの設定項目は次を参照してください。⇒『アイテムの各機能について』参照④　コピーや貼り付けなどの操作やアイテムの位置揃えなどは、操作ツールから行います。操作ツール一覧の詳細は次を参照してください。⇒『操作ツールの各機能について』参照⑤　アイテムの追加が完了したら、操作ツール一覧のをクリックしてエラーチェックを行います。 エラーがある場合は画面左側に［エラーメッセージ一覧］が表示されます。エラー内容を確認し設定を変更してください。⑥　をクリックしてプレビューを表示し、実際の申請書画面のイメージを確認します。⑦　プレビューに問題がなければ、［更新］をクリックして設定内容を保存します。保存が完了すると次のメッセージが表示されます。⑧　フォーム設定を行うと申請書のステータスが［無効］となり、従業員の申請書入力ができなくなるため、［有効］に変更する必要があります。ステータスを変更するには［…］の［有効／無効切替］をクリックします。⑨　確認メッセージが表示されるので［OK］をクリックします。ステータスが［有効］になっていれば完了です。</div></div><div id="WFL11007"><div class="search_breadcrumbs">フォーム設定 &gt; フォーム設定機能の概要 &gt; 便利な機能</div><div class="search_title">便利な機能</div><div class="displayText">便利な機能フォーム設定の便利な機能を紹介します。 項目を複数選択する［Shift］キーを押しながらキャンバス上の項目をクリックすると、項目の複数選択が可能です。複数の項目をまとめて ...</div><div class="search_word">便利な機能フォーム設定の便利な機能を紹介します。 項目を複数選択する［Shift］キーを押しながらキャンバス上の項目をクリックすると、項目の複数選択が可能です。複数の項目をまとめて移動したい場合や、一括でコピー・削除したい場合などに使用します。 右クリックでメニューを表示する項目を選択した状態で右クリックすると、コピーや削除、最前面・最背面への移動などを行うメニューが表示されます。 パレットにない色を枠線や背景にするパレットにない色を枠線や背景に使用する場合は、赤枠部分で調整します。</div></div><div id="WFL11009"><div class="search_breadcrumbs">フォーム設定 &gt; 操作ツールとアイテムについて &gt; 操作ツールの各機能について</div><div class="search_title">操作ツールの各機能について</div><div class="displayText">操作ツールの各機能についてフォーム設定画面の上部に表示される操作ツールの各機能について説明します。  フォーム設定用紙のサイズや向き、フォントの初期値など、申請書の基本設定を行いま ...</div><div class="search_word">操作ツールの各機能についてフォーム設定画面の上部に表示される操作ツールの各機能について説明します。  フォーム設定用紙のサイズや向き、フォントの初期値など、申請書の基本設定を行います。基本設定の詳細は次を参照してください。⇒『申請書の基本設定を行う』参照 ページ設定ページの切り替え・追加・削除・移動などを行います。ページ設定の詳細は次を参照してください。⇒『ページ設定を行う』参照元に戻す やり直す［ 元に戻す］操作を取り消します。［ やり直す］取り消した操作を再度実行します。 コピー選択中の項目をコピーします。 切り取り選択中の項目を切り取ります。 貼り付けコピーまたは切り取りをした項目を貼り付けます。 削除選択中の項目を削除します。 全選択 全選択解除表示中のページに配置されている項目の全選択、全選択の解除を行います。 グループ化 グループ化解除複数の項目のグループ化、グループ化の解除を行います。 位置揃え選択中の複数の項目の位置を揃えます。左揃え、右揃え、上揃え、下揃えが可能です。 サイズ揃え選択中の複数の項目のサイズを揃えます。選択中の複数の項目の中で、最大の幅または高さの項目に合わせて、すべての項目のサイズを揃えます。 タブ順序設定申請書入力時に［Tab］キーでカーソルが移動する順番を登録します。初期設定では、項目の追加順に順番が設定されていますが、［上へ］［下へ］で順番を調整します。［自動並び替え］をクリックすると、申請書の項目の位置（上から下へ、左から右へ）で自動で順番が設定されます。［ラベル］［査印］［イメージ］［QRコード］［ライン］［四角］［データ参照］は入力項目ではないため［タブ順序設定］の対象外です。 項目検索申請書に配置されている項目をアイテムの種類や項目名称で絞り込んで検索できます。『項目検索』の項目をクリックすると、その項目がキャンバス上のどの項目であるかを確認できます。 計算式一覧申請書に設定されている計算式を一覧で確認できます。 エラーチェック申請書に追加した項目のエラーチェックを行います。エラーがない場合は、右上に次のメッセージが表示されます。エラーがある場合は、画面左側にエラーメッセージ一覧が表示されます。</div></div><div id="WFL11010"><div class="search_breadcrumbs">フォーム設定 &gt; 操作ツールとアイテムについて &gt; 操作ツールの各機能について &gt; 申請書の基本設定を行う</div><div class="search_title">申請書の基本設定を行う</div><div class="displayText">申請書の基本設定を行う操作ツールのをクリックして用紙のサイズや向き、フォントの初期値など、申請書の基本設定を行います。用紙設定申請書の用紙の設定を行います。なお、申請書に項目が配置 ...</div><div class="search_word">申請書の基本設定を行う操作ツールのをクリックして用紙のサイズや向き、フォントの初期値など、申請書の基本設定を行います。用紙設定申請書の用紙の設定を行います。なお、申請書に項目が配置されている状態で用紙設定を変更すると、レイアウトが崩れる可能性があります。変更した場合は、必要に応じてレイアウトを修正してください。用紙サイズ用紙サイズを選択します。用紙の向き用紙の向きを選択します。グリッド幅キャンバスのグリッド幅（1マスの大きさ）を1~99の間で入力します。グリッドに合わせて変更項目をグリッドに沿って配置する場合は［ON］にします。［ON］の状態でも［↑・↓・←・→］キー（矢印キー）を操作することで、グリッドに関係なく1pxずつ位置を移動できます。 フォント初期設定申請書に追加する項目のフォントの初期値を設定します。なお、すでに申請書に配置されている項目は［フォント初期設定］の変更内容は反映されません。文字フォント文字フォントの初期値を設定します。文字サイズ文字サイズの初期値を設定します。スタイル太字または斜字を初期値として設定する場合は［ON］に切り替えます。文字色文字色の初期値を設定します。プレビュー［文字フォント］から［文字色］までの設定内容が反映されたフォントのプレビューが表示されます。 表示初期設定申請書に追加する項目の文字の配置と余白の初期値を設定します。なお、すでに申請書に配置されている項目は、［表示初期設定］の変更内容は反映されません。横配置項目内の文字の揃え方（水平方向）の初期値を設定します。縦配置［ラベル］の項目内の文字の揃え方（垂直方向）の初期値を設定します余白文字周辺の余白の初期値を設定します。余白を設定することで文字の入力開始位置を調整できます。 制御設定申請書に追加する日付入力項目の和暦／西暦の初期値と、ガイドエリア表示のON／OFFを設定します。和暦／西暦区分申請書に追加する日付入力項目の和暦／西暦の初期値を設定します。すでに申請書に配置されている日付入力項目は、［和暦／西暦区分］の変更内容は反映されません。ガイドエリア表示申請書の入力画面に、項目の説明を表示するエリアを設ける場合は［ON］に切り替えます。なお、このエリアを表示するには申請書入力画面の［入力ガイド表示］に✔がついている必要があります。エリアに表示する説明文は、各項目の［入力ガイド］に入力します。</div></div><div id="WFL11011"><div class="search_breadcrumbs">フォーム設定 &gt; 操作ツールとアイテムについて &gt; 操作ツールの各機能について &gt; ページ設定を行う</div><div class="search_title">ページ設定を行う</div><div class="displayText">ページ設定を行う操作ツールのをクリックして、ページの追加・コピー・削除などを行います。なお、キャンバスに表示するページを切り替える場合は［ページ設定］で任意のページをクリックします ...</div><div class="search_word">ページ設定を行う操作ツールのをクリックして、ページの追加・コピー・削除などを行います。なお、キャンバスに表示するページを切り替える場合は［ページ設定］で任意のページをクリックします。ページの追加・並び替え新しいページを追加する場合は［ページ追加］をクリックします。ページ数の上限は99枚です。ページを並び替える場合はドラッグ＆ドロップで、任意の場所に移動します。ただし、先頭のページは固定されているため並び替えはできません。ページのコピー・削除ページをコピー・削除する場合は、［…］でメニューを開き［コピー］・［削除］をクリックします。ただし、先頭のページは削除できません。 詳細設定を行う［…］から［詳細設定］をクリックして、ページ種別や背景色・背景画像を設定します。 ページNo．ページの番号が表示されます。ページ種別ページの種別を設定します。ただし、先頭のページは［必須ページ］から変更できません。［必須ページ］すべての項目が未入力のページも申請書に含める場合は、［必須ページ］を選択します。［任意ページ］すべての項目が未入力のページを申請書から除外する場合は、［任意ページ］を選択します。［台紙ページ］証憑などを貼り付けるページとする場合に選択します。申請書入力時には表示されません。出力時に出力する・しないを選択できます。背景色ページの背景色を設定します。背景画像［ファイル選択］をクリックして、選択中のページの背景画像を設定します。背景画像には以下の条件を満たすファイルを設定できます。ファイルサイズが1MB未満である。拡張子がjpg,jpeg,png,bmp,pdfのいずれかである。ただし、パスワードが掛かっているPDFファイルは、背景画像に設定できません。画像は申請書に合わせて拡大表示されるため、申請書のサイズと同じ画像をアップロードすることを推奨します。背景画像を削除する場合は、をクリック後、［OK］をクリックします。</div></div><div id="WFL11012"><div class="search_breadcrumbs">フォーム設定 &gt; 操作ツールとアイテムについて &gt; アイテムの各機能について</div><div class="search_title">アイテムの各機能について</div><div class="displayText">アイテムの各機能についてフォーム設定画面の左側に表示されるアイテムの各機能と設定方法について説明します。 アイテム名説明使用イメージ ラベル申請書にテキストを表示するアイテムです（ ...</div><div class="search_word">アイテムの各機能についてフォーム設定画面の左側に表示されるアイテムの各機能と設定方法について説明します。 アイテム名説明使用イメージ ラベル申請書にテキストを表示するアイテムです（入力項目ではありません）。タイトルや注意書き、入力例を申請書に表示する場合などに使用します。［ラベル］の設定方法は次を参照してください。⇒『ラベル』参照 文字入力１行以内で文字を入力するアイテムです。氏名や商品名を入力する項目を追加する場合などに使用します。複数行の入力する場合は［文字入力］ではなく［メモ入力］を使用します。［文字入力］の設定方法は次を参照してください。⇒『文字入力』参照数値入力数値を入力するアイテムです。金額や個数を入力する項目を追加する場合などに使用します。入力された数値をもとに、合計金額や日数計算などを自動で算出する計算式を設定することも可能です。［数値入力］の設定方法は次を参照してください。⇒『数値入力』参照 日付入力日付を入力するアイテムです。支払日や出張日などを選択する項目を追加する場合などに使用します。［日付入力］の設定方法は次を参照してください。⇒『日付入力』参照 コード入力『LucaTech GX』の共通マスターのコードを入力するアイテムです。社員コードや勘定科目コードなどを入力する項目を追加する場合などに使用します。なお、コードはをクリックして表示されるマスターから選択することも可能です。［コード入力］の設定方法は次を参照してください。⇒『コード入力』参照  メモ入力複数行の文字を入力するアイテムです。コメント欄や備考欄を追加する場合などに使用します。入力可能行数を1行とする場合は、［メモ入力］ではなく［文字入力］を使用します。［メモ入力］の設定方法は次を参照してください。⇒『メモ入力』参照 コンボボックスプルダウン形式の選択肢から、いずれかを選択するアイテムです。選択肢には、『LucaTech GX』の共通マスターやフリーマスターの登録内容、直接入力した項目を設定できます。支払い方法や部署をプルダウンから選択する項目を追加する場合などに使用します。［コンボボックス］の設定方法は次を参照してください。⇒『コンボボックス』参照 チェックボックス画面上に表示された選択肢に、チェックをつけるアイテムです。曜日など、複数選択できる項目を追加する場合などに使用します。［チェックボックス］の設定方法は次を参照してください。⇒『チェックボックス』参照 ラジオボタン画面上に表示された選択肢から、いずれか1つを選択するアイテムです。出張先（国内・国外）を選択する項目を追加する場合などに使用します。［ラジオボタン］の設定方法は次を参照してください。⇒『ラジオボタン』参照 グリッド（表）表を表示するアイテムです。複数の明細行を設ける場合などに使用します。［グリッド（表）］の設定方法は次を参照してください。⇒『グリッド（表）』参照 査印査印欄を表示するアイテムです（入力項目ではありません）。［査印］の設定方法は次を参照してください。⇒『査印』参照 イメージ画像を表示するアイテムです（入力項目ではありません）。会社のロゴを追加する場合などに使用します。［イメージ］の設定方法は次を参照してください。⇒『イメージ』参照 QRコードQRコードを表示するアイテムです（入力項目ではありません）。   QRコードから指定のURLにアクセスさせたい場合に使用します。［QRコード］の設定方法は次を参照してください。⇒『QRコード』参照 ライン（線）ライン（線）を表示するアイテムです（入力項目ではありません）。キャンバスに直線を描画する場合に使用します。［ライン（線）］の設定方法は次を参照してください。⇒『ライン（線）』参照 四角四角を表示するアイテムです（入力項目ではありません）。項目を強調させる場合などに使用します。キャンバスに四角を描画する場合に使用します。［四角］の設定方法は次を参照してください。⇒『四角』参照・ データ参照システムが取得した情報を自動で表示するアイテムです。申請日時に基づいて［申請日］を自動で表示させたい場合などに使用します。［データ参照］の設定方法は次を参照してください。⇒『データ参照』参照</div></div><div id="WFL11013"><div class="search_breadcrumbs">フォーム設定 &gt; 操作ツールとアイテムについて &gt; アイテムの各機能について &gt; 共通設定項目について</div><div class="search_title">共通設定項目について</div><div class="displayText">共通設定項目についてここでは、申請書に配置した項目の［項目名称］や項目を配置する［位置］、申請書に表示する［表示テキスト］など、複数のアイテムに共通する設定項目について説明します。 ...</div><div class="search_word">共通設定項目についてここでは、申請書に配置した項目の［項目名称］や項目を配置する［位置］、申請書に表示する［表示テキスト］など、複数のアイテムに共通する設定項目について説明します。基本項目名称項目を識別するための名称を設定します。ここで入力した項目名称は、申請書の入力画面には表示されません。フォーム設定時の項目検索や承認ルート登録時の条件分岐設定などに表示されます。同一の申請書内で同じ項目名称は設定できません。すべてのアイテムで設定する項目です。位置項目の位置を微調整する場合に、キャンバスの横方向（X）、縦方向（Y）の座標を設定します。ここで設定した座標に、項目の左上が配置されます。項目の位置を固定する場合は［移動禁止］を［ON］に設定します。すべてのアイテムで設定する項目です。サイズ項目の幅（W）と高さ（H）を設定します。すべてのアイテムで設定する項目です。表示テキスト申請書に表示するテキストを入力します。次のアイテムで設定する項目です。［ ラベル］［ 文字入力］［ 数値入力］［ メモ入力］［ チェックボックス］［ ラジオボタン］チェック状態入力時の初期値をチェックがついた状態にする場合は、［ON］に設定します。次のアイテムで設定する項目です。［ チェックボックス］［ ラジオボタン］表示申請書入力時や承認時に項目を表示させない場合は［非表示］に設定します（キャンバス上では表示されます）。すべてのアイテムで設定する項目です。入力項目を入力できないようにする場合は［入力不可］に設定します。次のアイテムで設定する項目です。［ 文字入力］［ 数値入力］［ 日付入力］［ コード入力］［ メモ入力］［ コンボボックス］［ チェックボックス］［ ラジオボタン］入力ガイド申請書入力画面で［入力ガイド表示］をONにしたとき、画面左下に表示される項目の説明文を入力します。次のアイテムで設定する項目です。［ 文字入力］［ 数値入力］［ 日付入力］［ コード入力］［ メモ入力］［ コンボボックス］［ チェックボックス］［ ラジオボタン］プレースホルダー記入例などを表示する場合は、テキストや数値を入力します。次のアイテムで設定する項目です。［ 文字入力］［ 数値入力］［ コード入力］［ メモ入力］［ コンボボックス］ フォント/線文字文字のフォント・サイズ・色を設定します。次のアイテムで設定する項目です。［ ラベル］［ 文字入力］［ 数値入力］［ 日付入力］［ コード入力］［ メモ入力］［ コンボボックス］［ チェックボックス］［ ラジオボタン］文字装飾［太字］［斜字］［下線］［縦書き］にする場合は［ON］に設定します。［下線］［縦書き］は［ラベル］アイテムのみ設定できます。次のアイテムで設定する項目です。［ ラベル］［ 文字入力］［ 数値入力］［ 日付入力］［ コード入力］［ メモ入力］［ コンボボックス］［ チェックボックス］［ ラジオボタン］文字表示文字の配置方法や、文字同士の間隔（単位:px）を設定します。［縦位置］では項目内の文字の垂直方向の揃え方を設定します。［縦方向］は［ラベル］アイテムのみ設定できます。［横位置］では項目内の文字の水平方向の揃え方を設定します。次のアイテムで設定する項目です。［ ラベル］［ 文字入力］［ 数値入力］［ 日付入力］［ コード入力］［ メモ入力］［ コンボボックス］余白文字周辺の余白を設定します。余白を設定することで文字の開始位置を調整できます。次のアイテムで設定する項目です。［ ラベル］［ 文字入力］［ 数値入力］［ 日付入力］［ コード入力］［ メモ入力］［ コンボボックス］背景項目に背景色を設定する場合は、［ON］にして背景色を選択します。次のアイテムで設定する項目です。［ ラベル］［ 文字入力］［ 数値入力］［ 日付入力］［ コード入力］［ メモ入力］［ コンボボックス］［ チェックボックス］［ ラジオボタン］［四角 ］枠線項目の枠線を表示する場合は、［ON］にして色、太さ、線種を選択します。次のアイテムで設定する項目です。［ ラベル］［ 文字入力］［ 数値入力］［ 日付入力］［ コード入力］［ メモ入力］［ コンボボックス］［ チェックボックス］［ ラジオボタン］［グリッド（表）］［査印］［イメージ］［四角］ 詳細イベント設定入力時に［経路検索］ボタンまたは［定期代検索］ボタンを表示させ、検索結果を指定した項目に自動で出力させる場合は、イベント設定を行います。次のアイテムで設定する項目です。［ 文字入力］［ 数値入力］［ 日付入力］［ メモ入力］イベント設定の方法は次を参照してください。⇒『イベント設定を行う』参照コピー先設定入力した内容を他の項目にそのままコピーする場合は、［ページ］と［項目選択］でコピー先を設定します。なお、コピー先として設定できるのは［ラベル］［文字入力］［メモ入力］アイテムです。次のアイテムで設定する項目です。［ 文字入力］［ 数値入力］［ 日付入力］［ コード入力］［ メモ入力］［ コンボボックス］2次元マスター設定『フリーマスター登録（2次元）』で登録した内容を設定します。『フリーマスター登録（2次元）』とは2つのマスターを選択し、その組み合わせごとにデータ（文字・数値）を登録する機能です。次のアイテムで設定する項目です。［ 文字入力］［ 数値入力］『フリーマスター（2次元）』と［2次元マスター設定］の設定方法は次を参照してください。⇒『フリーマスター（2次元）を登録する』参照 入力検証必須項目必須項目とする場合は［ON］に設定します。必須項目が未入力の場合、申請時にエラーとなります。次のアイテムで設定する項目です。［ 文字入力］［ 数値入力］［ 日付入力］［ コード入力］［ メモ入力］［ コンボボックス］</div></div><div id="WFL11014"><div class="search_breadcrumbs">フォーム設定 &gt; 操作ツールとアイテムについて &gt; アイテムの各機能について &gt; ラベル</div><div class="search_title">ラベル</div><div class="displayText">ラベル［ ラベル］は、申請書にテキストを表示するアイテムです（入力項目ではありません）。タイトルや注意書き、入力例を申請書に表示する場合などに使用します。ここでは、［ ラベル］アイ ...</div><div class="search_word">ラベル［ ラベル］は、申請書にテキストを表示するアイテムです（入力項目ではありません）。タイトルや注意書き、入力例を申請書に表示する場合などに使用します。ここでは、［ ラベル］アイテム独自の設定項目について説明します。［項目名称］や［位置］など、複数のアイテムに共通する設定項目については次を参照してください。⇒『共通設定項目について』参照 詳細URLリンク項目をクリックして特定のWebページに遷移させたい場合は、遷移させるURLを入力します。</div></div><div id="WFL11015"><div class="search_breadcrumbs">フォーム設定 &gt; 操作ツールとアイテムについて &gt; アイテムの各機能について &gt; 文字入力</div><div class="search_title">文字入力</div><div class="displayText">文字入力［ 文字入力］は、１行以内で文字を入力するアイテムです。氏名や商品名を入力する項目を追加する場合などに使用します。ここでは、［ 文字入力］アイテム独自の設定項目について説明 ...</div><div class="search_word">文字入力［ 文字入力］は、１行以内で文字を入力するアイテムです。氏名や商品名を入力する項目を追加する場合などに使用します。ここでは、［ 文字入力］アイテム独自の設定項目について説明します。［項目名称］や［位置］など、複数のアイテムに共通する設定項目については次を参照してください。⇒『共通設定項目について』参照詳細入力可能文字数入力可能な文字数の最大値を指定する場合は、文字数を99以内で入力します。最小値も指定する場合は、［文字数範囲］で設定を行います。パスワード入力した文字をマスキングする場合は、［ON］に設定します。［ON］に設定すると入力した文字が「・」で表示されます。 入力検証文字数範囲入力する文字数の最小値と最大値を指定する場合は、［ON］に設定して文字数を1~99の範囲で入力します。最大値のみ指定する場合は、［入力可能文字数］で設定を行います。入力可能文字種入力可能な文字を制限する場合に設定します。［指定しない］すべての文字種を入力対象とします。［半角英数字］半角英数字のみを入力対象とします。［半角カタカナ］半角カタカナのみを入力対象とします。［摘要文字］次の文字種のみを入力対象とします（全角は入力できません）。アルファベット（大文字のみ）・カタカナ（大文字のみ）・濁点/半濁点・数字・(),-./\｢｣の記号・スペース［フリー属性（共通マスタ）］次の文字種のみを入力対象とします（全角は入力できません）。アルファベット・カタカナ・数字・記号・（［設定］＞［導入処理］＞［会社基本情報登録］の［フリーコードに使用できる記号］に登録されている記号のみ）・スペース（先頭または末尾を除く）［フリー属性（共通マスタ以外）］次の文字種のみを入力対象とします（全角は入力できません）。アルファベット・カタカナ・数字イベント設定を行う申請書の入力時に、『駅すぱあと』で検索した駅名や定期代などを、指定した項目に自動で出力させる場合は、イベント設定を行います。イベント設定を行うと、設定した項目の入力時に［経路検索］ボタンまたは［定期代検索］ボタンが表示されます。経路検索のイメージ イベント設定を行う場合は、入力時にボタンを表示させたい項目を選択し、［イベント設定］の［詳細設定］をクリックします。 クリックすると［イベント設定］画面が表示されるので、表示させるボタンの種類や、ボタンを表示させるタイミング、検索結果を出力する項目などを設定し、［OK］をクリックします。 ［経路検索］ボタンを表示させる場合イベント種類イベントの種類［経路検索ボタンの表示］を選択します。発生タイミングボタンが表示されるタイミングを設定する項目です。［経路検索］ボタンは項目の入力時のみ表示されるため［設定対象項目の入力時］が自動で設定され、変更はできません。 連携先項目設定（経路情報）利用日経路検索時に入力した［利用日］の日付を申請書の項目に自動で表示させる場合は、出力先の項目を選択します。出力先として設定できるのは、［日付入力］の項目です。出発駅名到着駅名経路検索時に入力した出発駅または到着駅の名称を申請書の項目に自動で表示させる場合は、出力先の項目を選択します。出力先として設定できるのは、［文字入力］［メモ入力］の項目です。経路詳細経路情報を申請書の項目に自動で表示させる場合は、出力先の項目を選択します。出力先として設定できるのは、［文字入力］［メモ入力］の項目です。運賃検索した経路の運賃を申請書の項目に自動で表示させる場合は、出力先の項目を選択します。出力先として設定できるのは［数値入力］の項目です。距離検索した経路の距離を申請書の項目に自動で表示させる場合は、出力先の項目を選択します。出力先として設定できるのは、［文字入力］［メモ入力］の項目です。経路区分検索時に選択した経路の区分（早・楽・安・定）を申請書の項目に自動で表示させる場合は、出力先の項目を選択します。出力先として設定できるのは、［文字入力］［メモ入力］の項目です。片道／往復検索時に選択した［片道］または［往復］を申請書の項目に自動で表示させる場合は、出力先の項目を選択します。出力先として設定できるのは、［文字入力］［メモ入力］の項目です。運賃区分検索時に選択した［ICカード］または［現金］を申請書の項目に自動で表示させる場合は、出力先の項目を選択します。出力先として設定できるのは、［文字入力］［メモ入力］の項目です。出発駅コード到着駅コード経路検索時に入力した出発駅または到着駅の「駅すぱあとAPI」上の駅コードを申請書の項目に自動で表示させる場合は、出力先の項目を選択します。出力先として設定できるのは、［文字入力］［メモ入力］の項目です。 背景変更設定路線検索連携された項目の背景色を変更する連携先項目設定の設定により自動連携された項目の背景色を変更する場合は、ONに設定します。変更後の背景色［路線検索連携された項目の背景色を変更する］を［ON］に設定した場合、項目の背景色を選択します。 ［定期代検索］ボタンを表示させる場合イベント種類イベントの種類［定期代検索ボタンの表示］を選択します。発生タイミングボタンが表示されるタイミングを設定する項目です。［定期代検索］ボタンは項目の入力時のみ表示されるため［設定対象項目の入力時］が自動で設定され、変更はできません。 連携先項目設定（定期代情報）出発駅名到着駅名経路検索時に入力した［出発駅］または［到着駅］の名称を申請書の項目に自動で表示させる場合は、出力先の項目を選択します。出力先として設定できるのは、［文字入力］［メモ入力］の項目です。運賃検索した経路の運賃を申請書の項目に自動で表示させる場合は、出力先の項目を選択します。出力先として設定できるのは［数値入力］の項目です。距離検索した経路の距離を申請書の項目に自動で表示させる場合は、出力先の項目を選択します。出力先として設定できるのは、［文字入力］［メモ入力］の項目です。定期代1か月定期代3か月定期代6か月定期代12か月検索した経路の1か月・3か月・6か月・12か月の定期代を申請書の項目に自動で表示させる場合は、出力先の項目を選択します。出力先として設定できるのは［数値入力］の項目です。画面で選択された定期代検索時に選択した定期代を申請書の項目に自動で表示させる場合は、出力先の項目を選択します。出力先として設定できるのは［数値入力］の項目です。定期券の種類二区間定期など、検索時に選択した定期券の種類を申請時の項目に自動で出力させる場合は、出力先の項目を選択します。出力先として選択できるのは、［文字入力］［メモ入力］の項目です。出発駅コード到着駅コード経路検索時に入力した出発駅または到着駅の「駅すぱあとAPI」上の駅コードを申請書の項目に自動で表示させる場合は、出力先の項目を選択します。出力先として設定できるのは、［文字入力］［メモ入力］の項目です。定期区間経路経路情報を申請書の項目に自動で表示させる場合は、出力先の項目を選択します。出力先として設定できるのは、［文字入力］［メモ入力］の項目です。 背景変更設定路線検索連携された項目の背景色を変更する申請書入力時に、連携先項目設定の設定により自動連携された項目の背景色を変更する場合は、［ON］に設定します。変更後の背景色［路線検索連携された項目の背景色を変更する］を［ON］に設定した場合、項目の背景色を選択します。</div></div><div id="WFL11017"><div class="search_breadcrumbs">フォーム設定 &gt; 操作ツールとアイテムについて &gt; アイテムの各機能について &gt; 数値入力</div><div class="search_title">数値入力</div><div class="displayText">数値入力［ 数値入力］は、数値を入力するアイテムです。金額や個数を入力する項目を追加する場合などに使用します。入力された数値をもとに、合計金額や日数計算などを自動で算出する計算式を ...</div><div class="search_word">数値入力［ 数値入力］は、数値を入力するアイテムです。金額や個数を入力する項目を追加する場合などに使用します。入力された数値をもとに、合計金額や日数計算などを自動で算出する計算式を設定することも可能です。ここでは、［ 数値入力］アイテム独自の設定項目について説明します。［項目名称］や［位置］など、複数のアイテムに共通する設定項目については次を参照してください。⇒『共通設定項目について』参照フォント/線数値装飾数値の表示方法を設定します。［カンマ区切り］数値を3桁ごとでカンマで区切って表示する場合は［ON］に設定します。［0パディング］入力値が入力可能桁数に満たない場合、先頭に「0」を表示して入力可能桁数分を埋める場合は［ON］に設定します。たとえば［入力可能桁数］を［4］に設定している場合に「999」と入力すると、「0999」と表示されます。［マイナス赤表記］マイナスの数値を赤字で表示する場合は［ON］に設定します。 詳細入力可能桁数入力可能な桁数を指定する場合に入力します。実数は15以内、小数は9以内で入力します。マイナス入力マイナスの数値の入力を可能にする場合は［ON］に設定します。通貨表示入力した数値の前に、「￥」を表示させる場合は［円］を設定します。計算式設定計算式を設定します。計算式の設定方法は次を参照してください。⇒『計算式設定を行う』参照入力検証数値範囲入力可能な数値の最小値・最大値を指定する場合は、［ON］に設定して数値を入力します。計算式設定を行う申請書に配置した項目を使用して、計算式を設定します。たとえば、合計金額や日数などを自動で算出する計算式を設定する場合などに使用します。設定方法は次のとおりです。①　計算式で使用する項目と、計算結果を表示させる項目をキャンバス上に配置します。②　計算結果を表示させる項目を選択し、画面右側に表示される［計算式設定］の［詳細設定］をクリックします。［計算式設定］画面に切り替わります。③　演算子やデータ関数などを使用して［計算式］欄で計算式を作成します。キャンバス上の項目を計算式に追加する場合は、キャンバス上の項目またはをダブルクリックします。キャンバス上の複数の項目の合計値または平均値を計算式に追加する場合は、使用するキャンバス上の項目を［Shift］キーで複数選択し、［合計］または［平均］をクリックします。なお、［グリッド（表）］項目で［数値入力］項目の列を設定している場合、［数値入力］項目のタイトル行をクリックし、［合計］をクリックすると、その列の合計値が計算式に追加されます。キャンバス上の項目を［四捨五入］［切り上げ］［切り捨て］した値を計算式に追加する場合は、使用するキャンバス上の項目を選択してからクリックします。計算結果に対して［四捨五入］［切り上げ］［切り捨て］を行うことはできません。計算結果に［四捨五入］等の端数処理をする場合は、手順④で行います。キャンバス上に配置した2つの［日付入力］項目間の日数を計算する場合は、［日数計算］をクリックして［日数計算］画面で設定を行います。開始日を日数に含めない場合は、［開始日を日数に含める］の✔をはずします。たとえば、［開始日］が「2025年4月1日」、［終了日］が「2025年4月3日」の場合、［開始日を日数に含める］の✔をはずすと、計算結果は「2」となります。キャンバス上に配置した項目を使用した条件式を作成する場合は、［条件式設定］をクリックして［条件式設定］画面の設定を行います。［条件設定］には条件となる計算式を設定します。［出力内容設定］には条件に合致した場合・合致しない場合に出力する値を設定します。たとえば、支払金額が50,000円以上の場合は一律50,000円を表示し、支払金額が50,000円未満の場合は申請書上の支払金額の項目の額を表示する項目を作成する場合は、次の画面のとおり設定します。 条件式左辺条件式の左辺となる申請書上の項目を選択します。［文字入力］［メモ入力］［日付入力］［コンボボックス］［ラジオボタン］［数値入力］［チェックボックス］［コード入力］の項目が選択できます。比較符号条件式の右辺と左辺を比較する符号を選択します。条件式右辺条件式の右辺を設定します。［条件式左辺］が［ラジオボタン］［チェックボックス］アイテム以外の場合任意の値を条件式の右辺とする場合は、［直接入力］を選択し、条件とする値を直接入力します。申請書上の項目を条件式の右辺とする場合は、［項目選択］を選択し、条件とする項目を選択します。なお、ここで選択できる項目は、左辺と同じ種類の項目です。たとえば、左辺が［数値入力］項目の場合、［右辺］に設定できるのは［数値入力］項目のみとなります。［条件式左辺］が［ラジオボタン］［チェックボックス］アイテムの場合条件式左辺の項目が選択されている状態を条件にする場合は、［比較符号］を［==（左辺と右辺が等しい）］を選択し、［True（選択）］を選択します。条件式が真の場合の値条件式が偽の場合の値［条件式が真の場合の値］では条件に合致した場合に、［条件式が偽の場合の値］では条件が合致しない場合に、任意の値を出力する場合は、［直接入力］を選択し、出力する値を入力します。［条件式が真の場合の値］では条件に合致した場合に、［条件式が偽の場合の値］では条件が合致しない場合に、申請書上の項目の内容を出力する場合は、［項目選択］を選択し、内容を出力する項目を選択します。④　計算結果に端数が生じた場合、小数点以下の値に対して四捨五入、切り上げ、または切り捨ての処理を行う場合は、［端数処理］を［ON］に設定し、実行する処理と位を選択します。⑤　計算式の設定が完了したら、［確定して閉じる］をクリックします。</div></div><div id="WFL11019"><div class="search_breadcrumbs">フォーム設定 &gt; 操作ツールとアイテムについて &gt; アイテムの各機能について &gt; 日付入力</div><div class="search_title">日付入力</div><div class="displayText">日付入力［ 日付入力］は、日付を入力するアイテムです。支払日や出張日などを選択する項目を追加する場合などに使用します。ここでは、［ 日付入力］アイテム独自の設定項目について説明しま ...</div><div class="search_word">日付入力［ 日付入力］は、日付を入力するアイテムです。支払日や出張日などを選択する項目を追加する場合などに使用します。ここでは、［ 日付入力］アイテム独自の設定項目について説明します。［項目名称］や［位置］など、複数のアイテムに共通する設定項目については次を参照してください。⇒『共通設定項目について』参照基本日付書式日付の形式（［年月日］または［年月］）、元号の形式（［和暦］または［西暦］）、曜日表示の有無を設定します。 入力検証日付範囲入力可能な日付の範囲を設定します。［日付項目選択］同じページに配置している［日付入力］項目を入力可能範囲に設定する場合は、［日付項目選択］を選択し、入力可能範囲に設定する［日付入力］項目をリストから選択します。［直接入力］任意の日付を入力可能範囲に設定する場合は、［直接入力］を選択し、入力可能範囲に設定する日付をカレンダーから選択します。（自）または（至）の日付を入力可能範囲から除く場合は、［基準日を含む］の✔をはずします。たとえば、（至）が「2024年1月1日」の場合、［基準日を含む］の✔をはずすと、入力可能範囲は～2023年12月31日となります。休日この項目で休日が入力された場合に申請をエラーとするには、［休日チェック］を［ON］に設定し、休日を登録したカレンダーを［休日カレンダー］から選択します。［休日カレンダー］は『休日登録』に登録したカレンダーから選択します。</div></div><div id="WFL11020"><div class="search_breadcrumbs">フォーム設定 &gt; 操作ツールとアイテムについて &gt; アイテムの各機能について &gt; コード入力</div><div class="search_title">コード入力</div><div class="displayText">コード入力［ コード入力］は、『LucaTech GX』の共通マスターのコードを入力するアイテムです。社員コードや勘定科目コードなどを入力する項目を追加する場合などに使用します。な ...</div><div class="search_word">コード入力［ コード入力］は、『LucaTech GX』の共通マスターのコードを入力するアイテムです。社員コードや勘定科目コードなどを入力する項目を追加する場合などに使用します。なお、申請書の入力時にはをクリックして表示される画面から、入力するコードを選択することも可能です。 ここでは、［ コード入力］アイテム独自の設定項目について説明します。［項目名称］や［位置］など、複数のアイテムに共通する設定項目については次を参照してください。⇒『共通設定項目について』参照基本コードアイテム設定コードアイテム設定では、入力する共通マスターの種類などを設定します。コードアイテム設定の方法は次を参照してください。⇒『コードアイテム設定を行う』参照コードアイテム設定を行うコードアイテム設定では入力項目設定（必須）と出力先設定の2つの設定を行います。入力項目設定では、入力するコードに関する設定を行い、出力先設定では入力したコードをもとに表示させる情報と、その出力先を設定します。 入力項目設定を行う［マスター］で『LucaTech GX』の共通マスターのうち、コードを入力するマスターの種類を選択します。なお、選択したマスターによって設定項目が変わります。マスター別設定入力フィルター入力するコードの絞り込みに関する設定を行います。［分類指定］指定した分類に紐づくコードのみ入力可能とする場合に選択します。［分類指定］を選択後は、［分類フィルター設定］を設定します。［コード指定］指定したコードのみ入力可能とする場合に選択します。［コード指定］を選択後は、［コード指定］で入力可能とするコードを追加します。［指定しない］すべての登録内容を入力可能とします対象科目の指定方法［マスター］で［科目別補助］を選択した場合に表示されます。入力する科目別補助のコードの指定方法を選択します。［直接選択］直接選択した勘定科目に紐づく科目別補助のコードを入力する場合に選択します。［直接選択］を選択後は、［対象科目］で科目別補助を採用している勘定科目を設定します。［科目項目選択］［勘定科目］［勘定科目（非会計）］のマスターを設定しているコンボボックスまたはコード入力の項目を指定し、その項目で選択された勘定科目に紐づく科目別補助のコードを入力する場合に選択します。［科目項目選択］を選択後は、［対象項目］で［勘定科目］［勘定科目（非会計）］のマスターを設定しているコンボボックスまたはコード入力の項目を選択します。［固定摘要項目選択］［固定摘要］のマスターを設定しているコンボボックスまたはコード入力の項目を配置し、その項目で選択された固定摘要の貸方科目または借方科目に紐づく科目別補助のコードを入力する場合に選択します。［固定摘要項目選択］を選択後は、［固定摘要項目］で［固定摘要］のマスターを設定しているコンボボックスまたはコード入力の項目を、［賃借区分］で固定摘要の「借方」と「貸方」のどちらの科目の科目別補助のコードを入力するかを設定します。対象摘要分類の選択方法［マスター］で［固定摘要（基準）］［固定摘要（置換）］を選択した場合に表示されます。入力する固定摘要を絞り込む場合は、［指定しない］から変更します。［摘要分類選択］指定した摘要分類に紐づく固定摘要のコードを入力する場合に選択します。［摘要分類選択］を選択後は、［対象摘要分類］でどの摘要分類に紐づくコードを入力するかを選択します。［項目選択］申請書上で選択した摘要分類に紐づく固定摘要のコードを入力する場合に選択します。［摘要分類］のマスターを設定しているコンボボックスの項目を配置し、その項目で選択された分類に紐づく固定摘要のコードが表示されます。［項目選択］を選択後は、［対象項目］で［摘要分類］のマスターを設定しているコンボボックスまたはコード入力の項目を選択します。申請部門を初期表示［マスター］で［部門］を選択した場合に表示されます。申請時に、申請者の所属部門のコードが入力されている状態を初期状態とする場合は［する］を選択します。 分類フィルター設定［マスター別設定］の［表示フィルター］で［分類指定］を選択した場合に表示されます。分類指定方法 分類の指定方法を選択します。［直接指定］［マスター種類］で選択したマスターに関する分類を直接指定する場合に選択します。［直接指定］を選択後は、［分類マスター選択］で分類種別を選択し、［分類コード］で絞り込みたい分類のコードを選択します。［分類項目指定］分類の種別を選択するコンボボックスまたはコード入力の項目を配置し、その項目で選択された分類を表示する場合に選択します。［分類項目指定］を選択後は、［分類項目］で分類種別を選択するコンボボックスまたはコード入力の項目を選択します。 出力先設定を行う選択したコードをもとに、正式名称やフリガナなど、入力されたマスターに紐づく情報を申請書の他の項目に自動で表示できます。 ［出力先項目追加］をクリックして行を追加し、［マスター項目］で出力したい情報を、［出力先項目］で情報を表示する項目を選択します。</div></div><div id="WFL11022"><div class="search_breadcrumbs">フォーム設定 &gt; 操作ツールとアイテムについて &gt; アイテムの各機能について &gt; メモ入力</div><div class="search_title">メモ入力</div><div class="displayText">メモ入力［ メモ入力］は、複数行の文字を入力するアイテムです。コメント欄や備考欄を追加する場合などに使用します。ここでは、［ メモ入力］アイテム独自の設定項目について説明します。［ ...</div><div class="search_word">メモ入力［ メモ入力］は、複数行の文字を入力するアイテムです。コメント欄や備考欄を追加する場合などに使用します。ここでは、［ メモ入力］アイテム独自の設定項目について説明します。［項目名称］や［位置］など、複数のアイテムに共通する設定項目については次を参照してください。⇒『共通設定項目について』参照詳細入力可能文字数入力可能文字数を入力します（上限：9999文字）。</div></div><div id="WFL11023"><div class="search_breadcrumbs">フォーム設定 &gt; 操作ツールとアイテムについて &gt; アイテムの各機能について &gt; コンボボックス</div><div class="search_title">コンボボックス</div><div class="displayText">コンボボックス［ コンボボックス］は、プルダウン形式の選択肢から、いずれかを選択するアイテムです。選択肢には、『LucaTech GX』の共通マスターやフリーマスターの登録内容、直 ...</div><div class="search_word">コンボボックス［ コンボボックス］は、プルダウン形式の選択肢から、いずれかを選択するアイテムです。選択肢には、『LucaTech GX』の共通マスターやフリーマスターの登録内容、直接入力した項目を設定できます。支払い方法や部署をプルダウンから選択する項目を追加する場合などに使用します ここでは、［ コンボボックス］アイテム独自の設定項目について説明します。［項目名称］や［位置］など、複数のアイテムに共通する設定項目については次を参照してください。⇒『共通設定項目について』参照基本リストアイテム設定リストアイテム設定では、プルダウンに表示する選択肢を設定します。リストアイテム設定の方法は次を参照してください。⇒『リストアイテム設定を行う』参照 リストアイテム設定を行うリストアイテム設定では表示項目設定（必須）と出力先設定の2つの設定を行います。表示項目設定では、プルダウンに表示させる選択肢を設定し、出力先設定ではプルダウンで選択した内容をもとに表示させる情報と、その出力先を設定します。 表示項目設定を行うプルダウンに表示させるデータは次の3つから設定できます。『LucaTech GX』共通のマスター［種別］で［マスター］を選択し、［マスター］で使用するマスターを選択します。以降の項目の設定方法は、次を参照してください。⇒『『LucaTech GX』共通のマスターを選択肢に使用する』参照『フリーマスター登録』に登録しているマスター［種別］で［フリーマスター］を選択し、［マスター］で使用するフリーマスターを選択します。詳細の設定方法は、次を参照してください。直接入力したデータ［種別］で［直接入力］を選択し、［項目登録］で表示させるデータを登録します。 『LucaTech GX』共通のマスターを選択肢に使用する『LucaTech GX』共通のマスターを選択肢に使用する場合の選択肢の設定方法を説明します。なお、選択したマスターによって設定項目が変わります。マスター別設定表示フィルタープルダウンに表示する内容の絞り込みに関する設定を行います。［分類指定］指定した分類に紐づく選択肢のみ表示する場合に選択します。［分類指定］を選択後は、［分類フィルター設定］を設定します。［コード指定］指定した選択肢のみ表示する場合に選択します。［コード指定］を選択後は、［コード指定］で選択可能とするアイテムを追加します。［指定しない］すべての登録内容をプルダウンに表示します対象科目の指定方法［マスター］で［科目別補助］を選択した場合に表示されます。プルダウンに表示する科目別補助の指定方法を選択します。［直接選択］直接選択した勘定科目に紐づく科目別補助をプルダウンに表示する場合に選択します。［直接選択］を選択後は、［対象科目］で科目別補助を採用している勘定科目を設定します。［科目項目選択］［勘定科目］［勘定科目（非会計）］のマスターを設定しているコンボボックスまたはコード入力の項目を指定し、その項目で選択された勘定科目に紐づく科目別補助をプルダウンに表示する場合に選択します。［科目項目選択］を選択後は、［対象項目］で［勘定科目］［勘定科目（非会計）］のマスターを設定しているコンボボックスまたはコード入力の項目を選択します。［固定摘要項目選択］［固定摘要］のマスターを設定しているコンボボックスまたはコード入力の項目を配置し、その項目で選択された固定摘要に紐づく科目別補助をプルダウンに表示する場合に選択します。［固定摘要項目選択］を選択後は、［固定摘要項目］で［固定摘要］のマスターを設定しているコンボボックスまたはコード入力の項目を、［賃借区分］で固定摘要の「借方」と「貸方」のどちらの科目の科目別補助を選択肢として表示するかを設定します。［表示フィルター］で［コード指定］を選択していた場合でも、［科目項目選択］または［固定摘要項目選択］を選択するとコード指定はできません。対象摘要分類の選択方法［マスター］で［固定摘要（基準）］［固定摘要（置換）］を選択した場合に表示されます。プルダウンに表示する固定摘要を絞り込む場合は、［指定しない］から変更します。［摘要分類選択］指定した摘要分類に紐づく固定摘要を表示する場合に選択します。［摘要分類選択］を選択後は、［対象摘要分類］でどの摘要分類に紐づくコードを表示するかを選択します。［項目選択］申請書上で選択した摘要分類に紐づく固定摘要を表示する場合に選択します。［摘要分類］のマスターを設定しているコンボボックスまたはコード入力の項目を配置し、その項目で選択された分類に紐づく固定摘要がプルダウンに表示されます。［項目選択］を選択後は［対象項目］で［摘要分類］のマスターを設定しているコンボボックスまたはコード入力の項目を選択します。申請部門を初期表示［マスター］で［部門］を選択した場合に表示されます。申請時に、申請者の所属部門が選択されている状態を初期状態とする場合は［する］を選択します。 分類フィルター設定［マスター別設定］の［表示フィルター］で［分類指定］を選択した場合に表示されます。分類指定方法 分類の指定方法を選択します。［直接指定］［マスター種類］で選択したマスターに関する分類を直接指定する場合に選択します。［直接指定］を選択後は、［分類マスター選択］で分類種別を選択し、［分類コード］で絞り込みたい分類のコードを入力します。［分類項目指定］分類の種別を選択するコンボボックスまたはコード入力の項目を配置し、その項目で選択された分類をプルダウンに表示する場合に選択します。［分類項目指定］を選択後は、［分類項目］で分類種別を選択するコンボボックスまたはコード入力の項目を選択します。出力先設定を行う［表示項目設定］の［種別］で［マスター］または［フリーマスター］を選択した場合、プルダウンで選択した内容をもとに、コードや正式名称など、選択された内容に紐づく情報を申請書の他の項目に自動で表示できます。 ［出力先項目追加］をクリックして行を追加し、［マスター項目］で出力したい情報を、［出力先項目］で情報を表示する項目を選択します。</div></div><div id="WFL11025"><div class="search_breadcrumbs">フォーム設定 &gt; 操作ツールとアイテムについて &gt; アイテムの各機能について &gt; チェックボックス</div><div class="search_title">チェックボックス</div><div class="displayText">チェックボックス［ チェックボックス］は、画面上に表示された選択肢に、チェックをつけるアイテムです。曜日など、複数選択できる項目を追加する場合などに使用します。 ［ チェックボック ...</div><div class="search_word">チェックボックス［ チェックボックス］は、画面上に表示された選択肢に、チェックをつけるアイテムです。曜日など、複数選択できる項目を追加する場合などに使用します。 ［ チェックボックス］の設定項目についての説明は次を参照してください。⇒『共通設定項目について』参照</div></div><div id="WFL11026"><div class="search_breadcrumbs">フォーム設定 &gt; 操作ツールとアイテムについて &gt; アイテムの各機能について &gt; ラジオボタン</div><div class="search_title">ラジオボタン</div><div class="displayText">ラジオボタン［ ラジオボタン］は、画面上に表示された選択肢から、いずれかを選択するアイテムです。出張先（国内・国外）を選択する項目を追加する場合などに使用します。ここでは、［ ラジ ...</div><div class="search_word">ラジオボタン［ ラジオボタン］は、画面上に表示された選択肢から、いずれかを選択するアイテムです。出張先（国内・国外）を選択する項目を追加する場合などに使用します。ここでは、［ ラジオボタン］アイテム独自の設定項目について説明します。［項目名称］や［位置］など、複数のアイテムに共通する設定項目については次を参照してください。⇒『共通設定項目について』参照 基本ラジオグループグループとする［ラジオボタン］アイテムに、同一のグループ名称を入力します。同一のグループ名称を入力すると、1つのグループとして認識され、グループの中で1つだけ選択できるようになります。</div></div><div id="WFL11027"><div class="search_breadcrumbs">フォーム設定 &gt; 操作ツールとアイテムについて &gt; アイテムの各機能について &gt; グリッド（表）</div><div class="search_title">グリッド（表）</div><div class="displayText">グリッド（表）［グリッド（表）］は、申請書に表を表示するアイテムです。複数の明細行を設ける場合などに使用します。 ［グリッド（表）］アイテムをキャンバスにドラッグ＆ドロップすると、 ...</div><div class="search_word">グリッド（表）［グリッド（表）］は、申請書に表を表示するアイテムです。複数の明細行を設ける場合などに使用します。 ［グリッド（表）］アイテムをキャンバスにドラッグ＆ドロップすると、［グリッド（表）設定］画面が表示されます。必要な設定を行い、［OK］をクリックすると、申請書にグリッド（表）が追加されます。追加後に［グリッド（表）設定］の内容を変更したい場合は、グリッド（表）全体を選択し、画面右側に表示される［詳細設定］をクリックします。 入力行数グリッド（表）の縦の行数を入力します。（例）入力行数で「4」を入力した場合タイトル行の高さタイトル行の高さを入力します。入力行の高さ（１行あたり）入力行の１行あたりの高さを入力します。列設定列数や項目名称、項目種別などを設定します。グリッド（表）の横の列数を増やす場合は、［列追加］をクリックします。（例）列数が４列の場合［操作］をドラッグ＆ドロップすると列の順序を入れ替えることができます。をクリックすると列が削除されます。［列］列の番号が表示されます。［項目名称］タイトル行となる項目の名称を設定します。なお、ここで入力した項目名称は、画面上には表示されません。画面上に表示する名称（テキスト）は、［グリット（表）］項目を追加後、［表示テキスト］から設定を行います。［幅］列の幅を設定します。［項目種別］列の入力項目のアイテムの種別を設定します。配置したグリッド（表）は、キャンバス上では2行目以降の枠線が表示されませんが、申請書の入力時にはすべての入力行に枠線が表示されます。 グリッド（表）をキャンバスに配置後、必要に応じてグリッド（表）のタイトル行と明細行の編集を行います。変更したい項目をクリックすると画面右側に設定画面が表示されるので、設定内容を編集します（［項目名称］と［サイズ］は［グリッド（表）設定］画面で設定するため変更できません）。明細行の編集は1行目をクリックして行います。1行目の設定内容は、2行目以降にも反映されます。 ［項目名称］や［位置］など、複数のアイテムに共通する設定項目については次を参照してください。⇒『共通設定項目について』参照</div></div><div id="WFL11028"><div class="search_breadcrumbs">フォーム設定 &gt; 操作ツールとアイテムについて &gt; アイテムの各機能について &gt; 査印</div><div class="search_title">査印</div><div class="displayText">査印［ 査印］は、申請書に査印欄を表示するアイテムです（入力項目ではありません）。［ 査印］アイテムをキャンバスにドラッグ＆ドロップすると［査印設定］画面が表示され、［OK］をクリ ...</div><div class="search_word">査印［ 査印］は、申請書に査印欄を表示するアイテムです（入力項目ではありません）。［ 査印］アイテムをキャンバスにドラッグ＆ドロップすると［査印設定］画面が表示され、［OK］をクリックすると、申請書に査印が追加されます。追加後に［査印設定］の内容を変更したい場合は、［査印］項目を選択し、画面右側に表示される［詳細設定］をクリックします。 サイズ設定サイズ査印の大きさを入力します。表示設定表示形式査印の表示形式を設定します。印影表示［OFF］に設定すると、査印が申請書に表示されなくなります。ただし、［枠線有無］を［ON］に設定している場合、枠線は表示されます。たとえば、紙で申請書の回覧を行う場合は、［OFF］に設定して印刷することで、押印しながら回覧できます。表示内容（上段）表示内容（下段）［表示形式］で［日付印］を選択した場合のみ表示されます。日付印の上段と下段に表示させる内容をそれぞれ選択します。印刷設定印刷設定申請時とPDFファイル出力時の、査印の表示形式を分ける場合は［個別で設定する］を選択し［表示形式］や［印影設定］などを設定します。設定方法は、上記と同様です。 次の表では、［ 査印］アイテム独自の設定項目について説明します。［項目名称］や［位置］など、複数のアイテムに共通する設定項目については次を参照してください。⇒『共通設定項目について』参照基本査印No.査印No.が申請書に追加した順番で設定されます（1~22）。査印No.は、『承認ルート登録』の［査印欄］で使用されます。［査印欄］では、ユニットごとにどの査印欄に印影を印字するかを設定します。『承認ルート登録』については、次を参照してください。⇒『申請者・ 承認者・確認者を設定する』参照</div></div><div id="WFL11029"><div class="search_breadcrumbs">フォーム設定 &gt; 操作ツールとアイテムについて &gt; アイテムの各機能について &gt; イメージ</div><div class="search_title">イメージ</div><div class="displayText">イメージ［ イメージ］は、申請書に画像を表示するアイテムです（入力項目ではありません）。会社のロゴを追加する場合などに使用します。［ イメージ］アイテムをキャンバスにドラッグ＆ドロ ...</div><div class="search_word">イメージ［ イメージ］は、申請書に画像を表示するアイテムです（入力項目ではありません）。会社のロゴを追加する場合などに使用します。［ イメージ］アイテムをキャンバスにドラッグ＆ドロップすると、［イメージ設定］画面が自動で表示されます。［イメージ設定］画面でファイルを選択し［OK］をクリックすると、申請書に画像が追加されます。追加後に画像を変更したい場合は、［イメージ］項目を選択し、画面右側に表示される［詳細設定］をクリックします。 なお、申請書には以下の条件を満たす画像を追加できます。ファイルサイズが1MB未満である。拡張子がjpg,jpeg,png,bmp,pdfのいずれかである。ただし、パスワードが掛かっているPDFファイルは、背景画像に設定できません。 ［項目名称］や［位置］など、複数のアイテムに共通する設定項目については次を参照してください。⇒『共通設定項目について』参照</div></div><div id="WFL11030"><div class="search_breadcrumbs">フォーム設定 &gt; 操作ツールとアイテムについて &gt; アイテムの各機能について &gt; QRコード</div><div class="search_title">QRコード</div><div class="displayText">QRコード［ QRコード］は、申請書にQRコードを表示するアイテムです（入力項目ではありません）。［ QRコード］アイテムをキャンバスにドラッグ＆ドロップすると、［QRコード設定］ ...</div><div class="search_word">QRコード［ QRコード］は、申請書にQRコードを表示するアイテムです（入力項目ではありません）。［ QRコード］アイテムをキャンバスにドラッグ＆ドロップすると、［QRコード設定］画面が表示されます。必要な設定を行い、［OK］をクリックすると、申請書にQRコードが追加されます。QRコードが表示された申請書を出力し、スマートフォンなどでQRコードを読み取ることで、任意のページに遷移させることが可能です。追加後に［QRコード設定］の内容を変更したい場合は、［QRコード］項目を選択し、画面右側に表示される［詳細設定］をクリックします。 サイズQRコードのサイズを指定します。URLの指定方法QRコードのURLの指定方法を選択します。［この画面でURLを入力する］QRコードから遷移させるURLをこの画面で設定する場合に選択します。［申請・承認時にURLを入力する］QRコードから遷移させるURLを申請時または承認時に設定する場合に選択します。［申請書データを開くURLを自動設定する］申請後にその申請の申請書データを参照できるQRコードを表示させる場合に選択します（申請書の入力時には何も表示されません）。URLリンク［URLの指定方法］で［この画面でURLを入力する］を選択した場合に表示されます。QRコードから遷移させるURLを入力します。URLの入力項目［URLの指定方法］で［申請・承認時にURLを入力する］を選択した場合に表示されます。QRコードから遷移させるURLを入力する項目を指定します。なお、入力項目として指定できるのは、同じページに配置されている［文字入力］または［メモ入力］の項目です。 ［項目名称］や［位置］など、複数のアイテムに共通する設定項目については次を参照してください。⇒『共通設定項目について』参照</div></div><div id="WFL11031"><div class="search_breadcrumbs">フォーム設定 &gt; 操作ツールとアイテムについて &gt; アイテムの各機能について &gt; ライン（線）</div><div class="search_title">ライン（線）</div><div class="displayText">ライン（線）［ ライン］は、申請書にライン（線）を表示するアイテムです（入力項目ではありません）。項目同士の区切りを強調させる場合などに使用します。 設定項目については次を参照して ...</div><div class="search_word">ライン（線）［ ライン］は、申請書にライン（線）を表示するアイテムです（入力項目ではありません）。項目同士の区切りを強調させる場合などに使用します。 設定項目については次を参照してください。⇒『共通設定項目について』参照</div></div><div id="WFL11032"><div class="search_breadcrumbs">フォーム設定 &gt; 操作ツールとアイテムについて &gt; アイテムの各機能について &gt; 四角</div><div class="search_title">四角</div><div class="displayText">四角［ 四角］は、申請書に四角を表示するアイテムです（入力項目ではありません）。項目を強調させる場合などに使用します。 設定項目については次を参照してください。⇒『共通設定項目につ ...</div><div class="search_word">四角［ 四角］は、申請書に四角を表示するアイテムです（入力項目ではありません）。項目を強調させる場合などに使用します。 設定項目については次を参照してください。⇒『共通設定項目について』参照</div></div><div id="WFL11033"><div class="search_breadcrumbs">フォーム設定 &gt; 操作ツールとアイテムについて &gt; アイテムの各機能について &gt; データ参照</div><div class="search_title">データ参照</div><div class="displayText">データ参照［ データ参照］はシステムが取得した情報を、自動で表示するアイテムです。［申請者名称］を自動で表示させたい場合などに使用します。［ データ参照］アイテムをキャンバスにドラ ...</div><div class="search_word">データ参照［ データ参照］はシステムが取得した情報を、自動で表示するアイテムです。［申請者名称］を自動で表示させたい場合などに使用します。［ データ参照］アイテムをキャンバスにドラッグ＆ドロップすると［データ参照アイテム］画面が自動で表示されるので、項目を設定し［OK］をクリックすると、設定内容に応じた項目が追加されます。 項目種類［データ名］に表示される参照データ（申請書に自動で表示させる項目）をアイテムの種類で絞り込む場合は、［ラベル］［文字入力］［日付入力］［コード入力］から選択します。［すべて］を選択すると、［データ名］には選択可能な参照データがすべて表示されます。データ名参照データを選択します。 ［データ参照］アイテムで追加した項目は、［データ参照］に［データ参照アイテム］の［データ名］で選択した参照データが表示されます。なお、配置後の参照データの変更はできません。参照データを変更したい場合は、項目を削除して再度配置してください。 ［データ参照］として申請書に追加した［ラベル］［文字入力］［日付入力］［コード入力］項目と、通常の［ラベル］［文字入力］［日付入力］［コード入力］では設定できる内容が異なります。［データ参照］アイテムを使用して申請書に追加した項目は、次の内容を設定することができません。 アイテム名設定できない項目ラベル［表示テキスト］［URL］文字入力［表示テキスト］［入力］［入力ガイド］［プレースホルダー］［入力可能文字数］［パスワード］［イベント設定］［コピー先設定］［2次元マスター設定］［必須項目］［文字数範囲］［最小文字数］［最大文字数］［入力可能文字種］日付入力［入力］［入力ガイド］［イベント設定］［コピー先設定］［必須］［日付範囲］コード入力［コードアイテム設定］［入力］［入力ガイド］［プレースホルダー］［コピー先設定］［必須］</div></div></div>');
// ========================================
// グローバル変数定義
// ========================================

// MutationObserver機能用のグローバル変数
var currentSearchValue = ""; // 現在の検索キーワード
var mutationObserver = null; // MutationObserverインスタンス
var debounceTimer = null; // DOM変更用のデバウンスタイマー

// jQueryセレクタキャッシュ
var $cachedElements = {
    iframe: null,
    searchField: null,
    searchResultItemsBlock: null,
    searchResultsEnd: null,
    searchMsg: null,
    searchInput: null
};

// セレクタマップ（キャッシュ機構の効率化）
var selectorMap = {
    iframe: "iframe.topic",
    searchField: ".wSearchField",
    searchResultItemsBlock: ".wSearchResultItemsBlock",
    searchResultsEnd: ".wSearchResultsEnd",
    searchMsg: "#searchMsg",
    searchInput: ".search-input"
};

// HTMLエンティティ復元用の正規表現（効率化のためグローバル定義）
var htmlEntityRegexes = {
    nbsp: /&nbsp;(?=[^<>]*<)/gm,
    gt: /&gt;(?=[^<>]*<)/gm,
    lt: /&lt;(?=[^<>]*<)/gm,
    quot: /&quot;(?=[^<>]*<)/gm,
    amp: /&amp;(?=[^<>]*<)/gm
};

// 文字変換マップ（効率化のため初期化時に正規表現を構築）
var characterMappings = (function () {
    // 文字変換用の配列定義（配列リテラルに変更）
    var wide = ["０", "１", "２", "３", "４", "５", "６", "７", "８", "９", "ａ", "ｂ", "ｃ", "ｄ", "ｅ", "ｆ", "ｇ", "ｈ", "ｉ", "ｊ", "ｋ", "ｌ", "ｍ", "ｎ", "ｏ", "ｐ", "ｑ", "ｒ", "ｓ", "ｔ", "ｕ", "ｖ", "ｗ", "ｘ", "ｙ", "ｚ", "ガ", "ギ", "グ", "ゲ", "ゴ", "ザ", "ジ", "ズ", "ゼ", "ゾ", "ダ", "ヂ", "ヅ", "デ", "ド", "バ", "ビ", "ブ", "ベ", "ボ", "パ", "ピ", "プ", "ペ", "ポ", "。", "「", "」", "、", "ヲ", "ァ", "ィ", "ゥ", "ェ", "ォ", "ャ", "ュ", "ョ", "ッ", "ー", "ア", "イ", "ウ", "エ", "オ", "カ", "キ", "ク", "ケ", "コ", "サ", "シ", "ス", "セ", "ソ", "タ", "チ", "ツ", "テ", "ト", "ナ", "ニ", "ヌ", "ネ", "ノ", "ハ", "ヒ", "フ", "ヘ", "ホ", "マ", "ミ", "ム", "メ", "モ", "ヤ", "ユ", "ヨ", "ラ", "リ", "ル", "レ", "ロ", "ワ", "ン"];
    var narrow = ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "ｶﾞ", "ｷﾞ", "ｸﾞ", "ｹﾞ", "ｺﾞ", "ｻﾞ", "ｼﾞ", "ｽﾞ", "ｾﾞ", "ｿﾞ", "ﾀﾞ", "ﾁﾞ", "ﾂﾞ", "ﾃﾞ", "ﾄﾞ", "ﾊﾞ", "ﾋﾞ", "ﾌﾞ", "ﾍﾞ", "ﾎﾞ", "ﾊﾟ", "ﾋﾟ", "ﾌﾟ", "ﾍﾟ", "ﾎﾟ", "｡", "｢", "｣", "､", "ｦ", "ｧ", "ｨ", "ｩ", "ｪ", "ｫ", "ｬ", "ｭ", "ｮ", "ｯ", "ｰ", "ｱ", "ｲ", "ｳ", "ｴ", "ｵ", "ｶ", "ｷ", "ｸ", "ｹ", "ｺ", "ｻ", "ｼ", "ｽ", "ｾ", "ｿ", "ﾀ", "ﾁ", "ﾂ", "ﾃ", "ﾄ", "ﾅ", "ﾆ", "ﾇ", "ﾈ", "ﾉ", "ﾊ", "ﾋ", "ﾌ", "ﾍ", "ﾎ", "ﾏ", "ﾐ", "ﾑ", "ﾒ", "ﾓ", "ﾔ", "ﾕ", "ﾖ", "ﾗ", "ﾘ", "ﾙ", "ﾚ", "ﾛ", "ﾜ", "ﾝ"];
    var highlight = ["(?:０|0)", "(?:１|1)", "(?:２|2)", "(?:３|3)", "(?:４|4)", "(?:５|5)", "(?:６|6)", "(?:７|7)", "(?:８|8)", "(?:９|9)", "(?:ａ|a)", "(?:ｂ|b)", "(?:ｃ|c)", "(?:ｄ|d)", "(?:ｅ|e)", "(?:ｆ|f)", "(?:ｇ|g)", "(?:ｈ|h)", "(?:ｉ|i)", "(?:ｊ|j)", "(?:ｋ|k)", "(?:ｌ|l)", "(?:ｍ|m)", "(?:ｎ|n)", "(?:ｏ|o)", "(?:ｐ|p)", "(?:ｑ|q)", "(?:ｒ|r)", "(?:ｓ|s)", "(?:ｔ|t)", "(?:ｕ|u)", "(?:ｖ|v)", "(?:ｗ|w)", "(?:ｘ|x)", "(?:ｙ|y)", "(?:ｚ|z)", "(?:ガ|ｶﾞ)", "(?:ギ|ｷﾞ)", "(?:グ|ｸﾞ)", "(?:ゲ|ｹﾞ)", "(?:ゴ|ｺﾞ)", "(?:ザ|ｻﾞ)", "(?:ジ|ｼﾞ)", "(?:ズ|ｽﾞ)", "(?:ゼ|ｾﾞ)", "(?:ゾ|ｿﾞ)", "(?:ダ|ﾀﾞ)", "(?:ヂ|ﾁﾞ)", "(?:ヅ|ﾂﾞ)", "(?:デ|ﾃﾞ)", "(?:ド|ﾄﾞ)", "(?:バ|ﾊﾞ)", "(?:ビ|ﾋﾞ)", "(?:ブ|ﾌﾞ)", "(?:ベ|ﾍﾞ)", "(?:ボ|ﾎﾞ)", "(?:パ|ﾊﾟ)", "(?:ピ|ﾋﾟ)", "(?:プ|ﾌﾟ)", "(?:ペ|ﾍﾟ)", "(?:ポ|ﾎﾟ)", "(?:。|｡)", "(?:「|｢)", "(?:」|｣)", "(?:、|､)", "(?:ヲ|ｦ)", "(?:ァ|ｧ)", "(?:ィ|ｨ)", "(?:ゥ|ｩ)", "(?:ェ|ｪ)", "(?:ォ|ｫ)", "(?:ャ|ｬ)", "(?:ュ|ｭ)", "(?:ョ|ｮ)", "(?:ッ|ｯ)", "(?:ー|ｰ)", "(?:ア|ｱ)", "(?:イ|ｲ)", "(?:ウ|ｳ)", "(?:エ|ｴ)", "(?:オ|ｵ)", "(?:カ|ｶ)", "(?:キ|ｷ)", "(?:ク|ｸ)", "(?:ケ|ｹ)", "(?:コ|ｺ)", "(?:サ|ｻ)", "(?:シ|ｼ)", "(?:ス|ｽ)", "(?:セ|ｾ)", "(?:ソ|ｿ)", "(?:タ|ﾀ)", "(?:チ|ﾁ)", "(?:ツ|ﾂ)", "(?:テ|ﾃ)", "(?:ト|ﾄ)", "(?:ナ|ﾅ)", "(?:ニ|ﾆ)", "(?:ヌ|ﾇ)", "(?:ネ|ﾈ)", "(?:ノ|ﾉ)", "(?:ハ|ﾊ)", "(?:ヒ|ﾋ)", "(?:フ|ﾌ)", "(?:ヘ|ﾍ)", "(?:ホ|ﾎ)", "(?:マ|ﾏ)", "(?:ミ|ﾐ)", "(?:ム|ﾑ)", "(?:メ|ﾒ)", "(?:モ|ﾓ)", "(?:ヤ|ﾔ)", "(?:ユ|ﾕ)", "(?:ヨ|ﾖ)", "(?:ラ|ﾗ)", "(?:リ|ﾘ)", "(?:ル|ﾙ)", "(?:レ|ﾚ)", "(?:ロ|ﾛ)", "(?:ワ|ﾜ)", "(?:ン|ﾝ)"];

    // 全角→半角の変換マップを作成
    var wideToNarrowMap = {};
    var narrowToHighlightMap = {};

    for (var i = 0; i < wide.length; i++) {
        wideToNarrowMap[wide[i]] = narrow[i];
        // 半角文字をキーにしてハイライトパターンをマップ
        narrowToHighlightMap[narrow[i]] = highlight[i];
    }

    // 全角文字の正規表現パターンを作成（エスケープ処理を含む）
    var wideCharsPattern = wide.map(function (char) {
        return char.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
    }).join('|');

    var wideToNarrowRegex = new RegExp(wideCharsPattern, 'g');

    return {
        wideToNarrowMap: wideToNarrowMap,
        narrowToHighlightMap: narrowToHighlightMap,
        wideToNarrowRegex: wideToNarrowRegex,
        // 効率的な変換関数
        convertWideToNarrow: function (text) {
            return text.replace(wideToNarrowRegex, function (match) {
                return wideToNarrowMap[match] || match;
            });
        }
    };
})();

// ========================================
// 基本ユーティリティ関数（依存なし）
// ========================================

// セレクタ用のエスケープ処理
function selectorEscape(val) {
    return val.replace(/[-\/\\^$*+?.()|[\]{}\!]/g, '\\$&');
}

// 文字列を正規化（全角→半角カナ変換、小文字化）
function normalizeForSearch(text) {
    var normalized = text.toLowerCase();
    return characterMappings.convertWideToNarrow(normalized);
}

// HTMLエンティティを復元
function decodeHtmlEntities(html) {
    return html
        .replace(htmlEntityRegexes.nbsp, "　")
        .replace(htmlEntityRegexes.gt, ">")
        .replace(htmlEntityRegexes.lt, "<")
        .replace(htmlEntityRegexes.quot, '"')
        .replace(htmlEntityRegexes.amp, "&");
}

// ========================================
// キャッシュ管理関数
// ========================================

// キャッシュを初期化
function initializeCachedElements() {
    for (var key in selectorMap) {
        if (selectorMap.hasOwnProperty(key)) {
            if (key === 'searchInput') {
                $cachedElements[key] = $(selectorMap[key], document);
            } else {
                $cachedElements[key] = $(selectorMap[key]);
            }
        }
    }
}

// キャッシュされた要素を取得（存在チェック付き）
function getCachedElement(key) {
    if (!$cachedElements[key] || $cachedElements[key].length === 0) {
        // キャッシュが無効な場合は再取得
        if (selectorMap.hasOwnProperty(key)) {
            if (key === 'searchInput') {
                $cachedElements[key] = $(selectorMap[key], document);
            } else {
                $cachedElements[key] = $(selectorMap[key]);
            }
        }
    }
    return $cachedElements[key];
}

// ========================================
// 検索処理関連関数（依存関係順）
// ========================================

// 検索語を正規化してエスケープ
function prepareSearchWords(searchValue) {
    // 全角・半角スペースを統一して連続スペースを1つにまとめる
    var searchWordTmp = searchValue.replace(/[　\s]+/g, " ").trim().toLowerCase();
    searchWordTmp = characterMappings.convertWideToNarrow(searchWordTmp);

    var searchWord = searchWordTmp.split(" ");
    for (var i = 0; i < searchWord.length; i++) {
        searchWord[i] = selectorEscape(searchWord[i].replace(/>/g, "&gt;").replace(/</g, "&lt;"));
    }
    return searchWord;
}

// ハイライト用の正規表現パターンを生成
function createHighlightPattern(searchWords) {
    // 各検索ワードを全角・半角両対応のパターンに変換
    var patterns = searchWords.map(function(word) {
        // 2文字パターンを優先的にマッチさせる正規表現を作成
        var result = '';
        var pos = 0;
        
        while (pos < word.length) {
            var matched = false;
            
            // 2文字の組み合わせを試行
            if (pos + 1 < word.length) {
                var twoChar = word.substring(pos, pos + 2);
                var pattern = characterMappings.narrowToHighlightMap[twoChar];
                if (pattern) {
                    result += pattern;
                    pos += 2;
                    matched = true;
                }
            }
            
            // 1文字で処理
            if (!matched) {
                var char = word.charAt(pos);
                var pattern = characterMappings.narrowToHighlightMap[char];
                result += pattern || char.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                pos++;
            }
        }
        
        return result;
    });
    return patterns.join("|");
}

// iframeのbody要素を取得
function getIframeBody() {
    var $iframe = getCachedElement('iframe');
    if ($iframe.length === 0) return null;
    return $iframe.contents().find("body");
}

// iframeコンテンツにハイライトを適用
function applyHighlight(searchValue) {
    var $body = getIframeBody();
    if (!$body) return;

    var searchWords = prepareSearchWords(searchValue);
    var highlightPattern = createHighlightPattern(searchWords);
    var reg = new RegExp("(" + highlightPattern + ")(?=[^<>]*<)", "gmi");
    var html = $body.html();
    var decodedHtml = decodeHtmlEntities(html);
    var highlightedHtml = decodedHtml.replace(reg, "<font class='keyword' style='color:rgb(0, 0, 0); background-color:rgb(252, 255, 0);'>$1</font>");

    $body.html(highlightedHtml);
}

// キーワードのハイライトを削除
function removeHighlight() {
    var $body = getIframeBody();
    if (!$body) return;

    $body.find(".keyword").each(function () {
        var $this = $(this);
        $this.replaceWith($this.contents());
    });
}

// 検索結果をクリア
function clearSearchResults() {
    var $searchResultItemsBlock = getCachedElement('searchResultItemsBlock');
    var $searchResultsEnd = getCachedElement('searchResultsEnd');
    var $searchMsg = getCachedElement('searchMsg');

    $searchResultItemsBlock.html("");
    $searchResultsEnd.addClass("rh-hide");
    $searchResultsEnd.attr("hidden", "");
    $searchMsg.html("2つ以上の語句を入力して検索する場合は、スペース（空白）で区切ります。");
    removeHighlight();
    currentSearchValue = "";
    disconnectMutationObserver();
}

// ========================================
// MutationObserver関連関数
// ========================================

// キーワード要素のみの追加かどうかを判定
function isOnlyKeywordAddition(mutation) {
    if (mutation.addedNodes.length !== 1) {
        return false;
    }
    
    var node = mutation.addedNodes[0];
    if (node.nodeType !== Node.ELEMENT_NODE) {
        return false;
    }
    
    // 追加されたノードがキーワード要素か、キーワード要素を含むか
    return (node.classList && node.classList.contains('keyword')) ||
           (node.querySelector && node.querySelector('.keyword') !== null);
}

// デバウンスされた再ハイライト処理
function debouncedReHighlight() {
    if (debounceTimer) {
        clearTimeout(debounceTimer);
    }

    debounceTimer = setTimeout(function () {
        reHighlightAfterDomChange();
    }, 500);
}

// DOM変更後の再ハイライト処理
function reHighlightAfterDomChange() {
    if (!currentSearchValue || currentSearchValue.trim() === "") {
        return;
    }

    try {
        disconnectMutationObserver();
        removeHighlight();
        applyHighlight(currentSearchValue);

        setTimeout(function () {
            setupMutationObserver();
        }, 100);

        console.debug("DOM変更後に検索語を再ハイライトしました");
    } catch (error) {
        console.warn("DOM変更後の再ハイライトに失敗しました:", error);
        setupMutationObserver();
    }
}

// iframeコンテンツ用のMutationObserverをセットアップ
function setupMutationObserver() {
    disconnectMutationObserver();

    try {
        var $iframe = getCachedElement('iframe');
        if ($iframe.length === 0) return;

        var iframeDocument = $iframe[0].contentDocument || $iframe[0].contentWindow.document;
        if (!iframeDocument || !iframeDocument.body) return;

        mutationObserver = new MutationObserver(function (mutations) {
            if (!currentSearchValue || currentSearchValue.trim() === "") {
                return;
            }

            var shouldReHighlight = mutations.some(function(mutation) {
                if (mutation.type === 'characterData') {
                    return true;
                }
                
                if (mutation.type === 'childList') {
                    // キーワード要素自身の追加は無視
                    if (isOnlyKeywordAddition(mutation)) {
                        return false;
                    }
                    
                    // ノードの追加または削除があれば再ハイライト
                    return mutation.addedNodes.length > 0 || mutation.removedNodes.length > 0;
                }
                
                return false;
            });

            if (shouldReHighlight) {
                debouncedReHighlight();
            }
        });

        mutationObserver.observe(iframeDocument.body, {
            childList: true,
            subtree: true,
            characterData: true,
            attributes: false
        });

        console.debug("iframeコンテンツ用のMutationObserverをセットアップしました");
    } catch (error) {
        console.warn("MutationObserverのセットアップに失敗しました:", error);
    }
}

// MutationObserverを切断
function disconnectMutationObserver() {
    if (mutationObserver) {
        mutationObserver.disconnect();
        mutationObserver = null;
    }

    if (debounceTimer) {
        clearTimeout(debounceTimer);
        debounceTimer = null;
    }
}

// ========================================
// jQueryカスタムセレクタ
// ========================================

// カスタムの:contains()セレクタ（正規化された検索用）
$.expr[':'].containsNormalized = function (elem, index, match) {
    var normalizedElemText = normalizeForSearch($(elem).text());
    var normalizedSearchText = normalizeForSearch(match[3]);
    return normalizedElemText.indexOf(normalizedSearchText) >= 0;
};

// ========================================
// jQueryイベントハンドラー
// ========================================

$(function () {
    // 要素のキャッシュを初期化
    initializeCachedElements();

    $(document).on("click", "ul.toc li.book", function () {
        if ($(this).children("a[href='#'],a[href='javascript:void 0;']").length == 0) {
            $(this).children("a").each(function () {
                location.href = location.href.replace(location.hash, "") + "#t=" + $(this).attr("href");
            });
        }
    });

    getCachedElement('searchField').each(function () {
        $(this).off();
    });

    $(document).on("keyup", ".wSearchField", function () {
        var $searchResultItemsBlock = getCachedElement('searchResultItemsBlock');
        var $searchResultsEnd = getCachedElement('searchResultsEnd');
        var $searchMsg = getCachedElement('searchMsg');
        var searchValue = $(this).val();

        // trim()を追加してスペースのみの入力も空として扱う
        if (searchValue.trim() === "") {
            clearSearchResults();
            return;
        }

        $searchMsg.html("");
        currentSearchValue = searchValue; // 現在の検索値を保存
        
        // スペースを正規化
        var searchWordTmp = searchValue.replace(/[　\s]+/g, " ").trim();
        // 正規化（全角→半角カナ、小文字化）
        searchWordTmp = normalizeForSearch(searchWordTmp);

        // 正規化後も空文字列チェックを追加
        if (searchWordTmp === "") {
            clearSearchResults();
            return;
        }

        var searchWord = searchWordTmp.split(" ");
        var searchQuery = searchWord.map(function(word) {
            return ":containsNormalized(" + word + ")";
        }).join("");

        var findItems = searchWords.find(".search_word" + searchQuery);
        if (findItems.length !== 0) {
            $searchResultsEnd.removeClass("rh-hide");
            $searchResultsEnd.removeAttr("hidden");
            $searchResultItemsBlock.html("");
            findItems.each(function () {
                var displayText = $(this).parent().find(".displayText").text();
                var parentId = $(this).parent().attr("id");
                var searchTitle = $(this).parent().find(".search_title").html();
                
                var resultHtml = "<div class='wSearchResultItem'>" +
                    "<a class='nolink' href='./" + parentId + ".html'>" +
                    "<div class='wSearchResultTitle'>" + searchTitle + "</div>" +
                    "</a>" +
                    "<div class='wSearchContent'>" +
                    "<span class='wSearchContext'>" + displayText + "</span>" +
                    "</div></div>";
                
                $searchResultItemsBlock.append($(resultHtml));
            });
            removeHighlight();
            applyHighlight(currentSearchValue);
        }
        else {
            removeHighlight();
            $searchResultsEnd.addClass("rh-hide");
            $searchResultsEnd.attr("hidden", "");
            $searchResultItemsBlock.html("");
            var displayText = "検索条件に一致するトピックはありません。";
            $searchResultItemsBlock.append($("<div class='wSearchResultItem'><div class='wSearchContent'><span class='wSearchContext'>" + displayText + "</span></div></div>"));
        }
    });

    getCachedElement('iframe').on("load", function () {
        var $searchInput = getCachedElement('searchInput');
        var $searchField = getCachedElement('searchField');

        if ($searchInput.is(":not(.rh-hide)") && ($searchField.val() != "")) {
            var searchValue = $searchField.val();
            currentSearchValue = searchValue; // 現在の検索値を保存
            applyHighlight(searchValue);
        }

        // iframeコンテンツ変更用のMutationObserverをセットアップ
        setupMutationObserver();
    });
});
