var searchWords = $('<div class="search"><div id="CMN11001"><div class="search_breadcrumbs">導入処理 &gt; はじめに</div></div><div id="CMN11003"><div class="search_breadcrumbs">導入処理 &gt; 導入処理 &gt; 導入の流れ</div><div class="search_title">導入の流れ</div><div class="displayText">導入の流れ『LucaTech GX』でマスターを新規に登録する場合の設定手順について説明します。 処理権限の管理方法は次の2種類があり、それぞれの方法によって導入手順が異なります。 ...</div><div class="search_word">導入の流れ『lucatech gx』でﾏｽﾀｰを新規に登録する場合の設定手順について説明します｡ 処理権限の管理方法は次の2種類があり､それぞれの方法によって導入手順が異なります｡担当者区分～処理可能部門を組み合わせて権限管理する､またはﾜｰｸﾌﾛｰｼｽﾃﾑを使用する場合担当者区分・個人番号区分のみで権限管理する場合 担当者区分～処理可能部門を組み合わせて権限管理する､またはﾜｰｸﾌﾛｰｼｽﾃﾑを使用する場合step1ﾛｸﾞｲﾝの基本情報を設定する［処理権限管理設定］で［設定する］を選択します｡ｼｽﾃﾑ別ﾏｽﾀｰを選択した場合､および共通ﾏｽﾀｰを選択し社外のﾕｰｻﾞｰを担当者として登録する場合は［担当者同時作成設定］で［担当者として作成する］を選択します｡すべての会社で共通する設定です｡⇒『ﾛｸﾞｲﾝ基本設定』参照ﾊﾟｽﾜｰﾄﾞおよびｱｶｳﾝﾄのﾎﾟﾘｼｰを設定する場合ﾎﾟﾘｼｰを設定するﾊﾟｽﾜｰﾄﾞの有効期限や複雑さ､およびｱｶｳﾝﾄのﾛｯｸ条件を設定します｡すべての会社で共通する設定です｡⇒『ﾎﾟﾘｼｰ設定』参照step2会社を作成する会社を新規に作成します｡ﾏｽﾀｰの管理方法を選択します｡⇒『会社作成処理』参照step3会社の基本情報を登録する会社の基本情報登録の登録や､業務ｼｽﾃﾑの選択､ﾏｽﾀｰの採用､休日の登録を行います｡⇒『会社基本情報登録』参照⇒『利用ｼｽﾃﾑ設定』参照⇒『ﾏｽﾀｰ採用情報登録』参照⇒『休日登録』参照step4ﾛｸﾞｲﾝｱｶｳﾝﾄを作成するﾛｸﾞｲﾝｱｶｳﾝﾄを作成し､ｱｶｳﾝﾄごとに［担当者区分］を設定します｡ﾕｰｻﾞｰの招待はまだ行いません｡［紐付け先社員］で［新規社員登録］をｸﾘｯｸして社員を同時に登録し､ﾛｸﾞｲﾝｱｶｳﾝﾄと紐付けます｡また『ﾛｸﾞｲﾝ基本情報』の［担当者同時作成設定］で［担当者として作成する］を選択した場合は［紐付け先担当者］で［新規担当者登録］をｸﾘｯｸして担当者を会社に紐付けます｡⇒『ﾛｸﾞｲﾝｱｶｳﾝﾄ設定』参照step5所属体系のﾏｽﾀｰを登録する部門・役職・社員の所属体系のﾏｽﾀｰを登録します｡⇒『部門登録』参照⇒『部門所属体系登録』参照⇒『役職登録』参照⇒『役職体系登録』参照⇒『社員登録』参照⇒『所属人員登録』参照step6業務ｼｽﾃﾑのﾏｽﾀｰを登録する各業務ｼｽﾃﾑに必要なﾏｽﾀｰを登録します｡⇒『科目登録』参照⇒『科目別補助登録』参照⇒『銀行登録』参照⇒『取引先登録』参照⇒『汎用補助登録』参照⇒『固定摘要登録』参照step7各業務ｼｽﾃﾑの導入設定を行う業務ｼｽﾃﾑごとに導入設定を行います｡財務会計⇒『』参照資産管理⇒『』参照ﾜｰｸﾌﾛｰ⇒『』参照会社作成時に『共通ﾏｽﾀｰ』を選択した場合業務ｼｽﾃﾑ別にﾏｽﾀｰの表示内容を変更する財務会計ｼｽﾃﾑおよび資産管理ｼｽﾃﾑで表示するﾏｽﾀｰを設定します｡⇒『ｼｽﾃﾑ別表示設定』参照役割ごとにﾒﾆｭｰの表示を設定する場合ﾒﾆｭｰﾊﾟﾀｰﾝを登録する権限ごとにﾒﾆｭｰﾊﾟﾀｰﾝを作成します｡⇒『ﾒﾆｭｰﾊﾟﾀｰﾝ登録』参照処理ごとに操作権限を設定する場合ﾛｰﾙを登録する処理の操作を制限するﾛｰﾙを作成します｡⇒『ﾛｰﾙ登録』参照step8処理権限を登録する『ﾒﾆｭｰﾊﾟﾀｰﾝ登録』『ﾛｰﾙ登録』を組み合わせて処理権限を登録します｡⇒『処理権限登録』参照step9処理権限を付与する『処理権限登録』で登録した処理権限を､社員ﾏｽﾀｰ・役職ﾏｽﾀｰ・部門ﾏｽﾀｰ・担当者ﾏｽﾀｰのいずれかに付与します｡⇒『処理権限付与』参照ﾛｸﾞｲﾝｱｶｳﾝﾄと社員ﾏｽﾀｰが紐づいていない場合ﾛｸﾞｲﾝｱｶｳﾝﾄと社員の紐付けﾛｸﾞｲﾝｱｶｳﾝﾄと社員ﾏｽﾀｰを紐づけます｡⇒『処理権限付与 ﾛｸﾞｲﾝｱｶｳﾝﾄと社員を紐づける』参照step10ﾎﾟｰﾀﾙ設定ﾎｰﾑ画面（ﾎﾟｰﾀﾙ）に表示する機能の設定を行います｡⇒『ﾎﾟｰﾀﾙ設定』参照step11ﾛｸﾞｲﾝｱｶｳﾝﾄを招待するﾛｸﾞｲﾝｱｶｳﾝﾄを招待します｡⇒『ﾛｸﾞｲﾝｱｶｳﾝﾄ設定 招待する』参照 担当者区分・個人番号区分のみで権限管理する場合step1処理権限の管理方法と担当者の同時作成設定を行う［処理権限管理設定］で［設定しない］を選択します｡［担当者同時作成設定］で［担当者として作成する］を選択します｡⇒『ﾛｸﾞｲﾝ基本設定』参照ﾊﾟｽﾜｰﾄﾞおよびｱｶｳﾝﾄのﾎﾟﾘｼｰを設定する場合ﾎﾟﾘｼｰを設定するﾊﾟｽﾜｰﾄﾞの有効期限や複雑さおよび､ｱｶｳﾝﾄのﾛｯｸ条件を設定します｡すべての会社で共通する設定です｡⇒『ﾎﾟﾘｼｰ設定』参照step2会社を作成する会社を新規に作成します｡ﾏｽﾀｰの管理方法を選択します｡⇒『会社作成処理』参照step3会社の基本情報を登録する会社の基本情報登録の登録や､業務ｼｽﾃﾑの選択・ﾏｽﾀｰの採用､休日の登録を行います｡⇒『会社基本情報登録』参照⇒『利用ｼｽﾃﾑ設定』参照⇒『ﾏｽﾀｰ採用情報登録』参照⇒『休日登録』参照step4ﾛｸﾞｲﾝｱｶｳﾝﾄを作成するﾛｸﾞｲﾝｱｶｳﾝﾄを作成し､ｱｶｳﾝﾄごとに［担当者区分］を設定します｡ﾕｰｻﾞｰの招待はまだ行いません｡［紐付け先担当者］で［新規担当者登録］をｸﾘｯｸして担当者を同時に登録し､担当者を会社に紐付けます｡⇒『ﾛｸﾞｲﾝｱｶｳﾝﾄ設定』参照step5業務ｼｽﾃﾑのﾏｽﾀｰを登録する各業務ｼｽﾃﾑに必要なﾏｽﾀｰを登録します｡⇒『銀行登録』参照⇒『取引先登録』参照⇒『汎用補助登録』参照⇒『固定摘要登録』参照step6各業務ｼｽﾃﾑの導入設定を行う業務ｼｽﾃﾑごとに導入設定を行います｡財務会計⇒『』参照資産管理⇒『』参照会社作成時に『共通ﾏｽﾀｰ』を選択した場合業務ｼｽﾃﾑ別にﾏｽﾀｰの表示内容を変更する財務会計ｼｽﾃﾑおよび固定資産ｼｽﾃﾑで表示するﾏｽﾀｰを設定します｡⇒『ｼｽﾃﾑ別表示設定』参照『ﾛｸﾞｲﾝ基本設定』で［担当者同時作成設定］を［ﾛｸﾞｲﾝｱｶｳﾝﾄのみ作成する］を選択した場合担当者ｸﾞﾙｰﾌﾟと担当者ﾏｽﾀｰを登録する担当者とﾛｸﾞｲﾝｱｶｳﾝﾄを紐付けて､担当者ﾏｽﾀｰを登録します｡⇒『処理権限付与　担当者を登録する』参照step7ﾎﾟｰﾀﾙ設定ﾎｰﾑ画面（ﾎﾟｰﾀﾙ）に表示する機能の設定を行います｡⇒『ﾎﾟｰﾀﾙ設定』参照step8ﾛｸﾞｲﾝｱｶｳﾝﾄを招待するﾛｸﾞｲﾝｱｶｳﾝﾄを招待します｡⇒『ﾛｸﾞｲﾝｱｶｳﾝﾄ設定 招待する』参照</div></div><div id="CMN11004"><div class="search_breadcrumbs">導入処理 &gt; 導入処理 &gt; 会社基本情報を登録する</div><div class="search_title">会社基本情報を登録する</div><div class="displayText">会社基本情報を登録する　［設定］＞［導入処理］＞［会社情報］＞［会社基本情報登録］会社名や法人番号などの会社情報、代表者や役職者を設定します。［基本情報］タブ 会社コード選択してい ...</div><div class="search_word">会社基本情報を登録する　［設定］＞［導入処理］＞［会社情報］＞［会社基本情報登録］会社名や法人番号などの会社情報､代表者や役職者を設定します｡［基本情報］ﾀﾌﾞ 会社ｺｰﾄﾞ選択している会社の会社ｺｰﾄﾞが表示されます｡正式会社名会社名を変更する場合は､60文字以内で入力します｡簡略会社名ｼｽﾃﾑの画面上で表示される名称です｡正式会社名の［簡略会社名へｺﾋﾟｰ］をｸﾘｯｸすると､入力した会社名の15文字分が［簡略会社名］へｺﾋﾟｰされます｡修正する場合は15文字以内で入力します｡ﾌﾘｶﾞﾅ会社名のﾌﾘｶﾞﾅを90文字以内で入力します｡法人番号法人番号を入力またはをｸﾘｯｸして検索します｡和暦／西暦区分年の表示・入力方法を［和暦］または［西暦］から選択します｡会計期間選択している会社の会計期間が表示されます｡変更はできません｡月次開始日月次開始日が表示されます｡変更はできません｡設立年月日設立年月日をｶﾚﾝﾀﾞｰから選択または西暦で直接入力します｡決算期（期数）当期の期数を入力します｡代表者役職名代表者の役職名を入力します｡代表者氏名代表者の氏名を入力します｡代表者名ﾌﾘｶﾞﾅ代表者氏名のﾌﾘｶﾞﾅを入力します｡郵便番号会社所在地の郵便番号を入力し､をｸﾘｯｸして住所を検索します｡検索結果に表示された住所を選択して［ok］をｸﾘｯｸすると､住所が自動で反映されます｡住所上段住所下段会社所在地の住所を30文字以内で入力します｡をｸﾘｯｸすると郵便番号を検索できます｡住所上段ﾌﾘｶﾞﾅ住所下段ﾌﾘｶﾞﾅ住所のﾌﾘｶﾞﾅを入力します｡電話番号fax番号電話番号とfax番号を入力します｡日次入力確定採用区分仕訳ﾃﾞｰﾀの確定処理を日次で行う場合は［採用］を選択します｡月次で行う場合は［未採用］に変更します｡ｼｽﾃﾑ別表示設定採用区分財務会計や固定資産の業務ｼｽﾃﾑごとに表示するﾏｽﾀｰを変える場合は［採用］を選択します｡表示の設定は［設定］＞［ﾏｽﾀｰ登録処理］＞［その他］＞［ｼｽﾃﾑ別表示設定］で行います｡ﾐﾄﾞﾙﾈｰﾑ採用区分『社員登録』などでﾐﾄﾞﾙﾈｰﾑを登録する場合は［採用］を選択します｡ﾌﾘｰｺｰﾄﾞに使用する記号ﾏｽﾀｰや伝票noのｺｰﾄﾞ属性が｢ﾌﾘｰ｣の場合で､半角ｶﾀｶﾅ､半角数字､半角ｱﾙﾌｧﾍﾞｯﾄ（大文字・小文字）以外をｺｰﾄﾞに使用したいときは､使用する記号を入力します｡複数の記号を登録する場合はｽﾍﾟｰｽなどで区切らず､続けて入力します｡最大10個まで入力できます｡  ｼｽﾃﾑが正常に稼動しなくなる可能性があるため､次の記号は登録しないでください｡ｼﾝｸﾞﾙｺｰﾄ（’）､ﾀﾞﾌﾞﾙｺｰﾄ（”）､ﾊﾟｰｾﾝﾄ（%） ﾌﾘｰ項目登録［基本情報］ﾀﾌﾞの項目を追加する場合は［ﾌﾘｰ項目採用情報設定］で登録します｡会社の基本情報に関する項目やﾒﾓを追加で登録できます｡ ［ﾌﾘｰ項目採用情報設定］画面 ﾌﾘｰ項目名称項目の名前を登録します｡採用項目の表示／非表示を切り替えます｡ ［代表者／役職者］ﾀﾌﾞ代表者､取締役､監査役を設定します｡［設定］＞［ﾏｽﾀ登録処理］＞［社員関係］＞［社員登録］および［役職登録］＞［役職登録］で社員および役職を登録している場合は､をｸﾘｯｸして社員と役職を選択します｡社員ｺｰﾄﾞを入力せずに氏名のみを登録することも可能です｡</div></div><div id="CMN11005"><div class="search_breadcrumbs">導入処理 &gt; 導入処理 &gt; マスター採用情報を登録する</div><div class="search_title">マスター採用情報を登録する</div><div class="displayText">マスター採用情報を登録する［設定］＞［導入処理］＞［会社情報］＞［マスター採用情報登録］システムで利用するマスターを採用（登録）します。 ［マスター採用情報］タブ［採用区分］から［ ...</div><div class="search_word">ﾏｽﾀｰ採用情報を登録する［設定］＞［導入処理］＞［会社情報］＞［ﾏｽﾀｰ採用情報登録］ｼｽﾃﾑで利用するﾏｽﾀｰを採用（登録）します｡ ［ﾏｽﾀｰ採用情報］ﾀﾌﾞ［採用区分］から［予算採用］までを指定して､ｼｽﾃﾑで利用するﾏｽﾀｰと桁数などを登録します｡［採用区分］と［ﾏｽﾀｰ名称］を指定して［条件で出力］をｸﾘｯｸすると､登録内容が表示されます｡ ﾏｽﾀｰ区分利用可能なﾏｽﾀｰが表示されます｡採用区分利用するﾏｽﾀｰを［採用あり］に変更します｡［ﾏｽﾀｰ区分］によって､［p/lのみ採用］か［b/s&amp;p/l採用］を選択します｡［p/lのみ採用］p/l科目の仕訳ﾃﾞｰﾀなどには､そのﾏｽﾀｰの入力が必須となります｡［b/s&amp;p/l採用］b/s科目またはp/l科目の仕訳ﾃﾞｰﾀなどには､そのﾏｽﾀｰの入力が必須となります｡ﾏｽﾀｰ名称ｼｽﾃﾑに表示されるﾏｽﾀｰの名称を､20文字以内で変更します｡［科目］［科目別補助］［資金繰科目］［c/f科目］は､変更できません｡桁数ﾏｽﾀｰごとに､ｺｰﾄﾞの桁数を入力します｡［科目］［科目別補助］［c/f科目］は､変更できません｡属性ｺｰﾄﾞの属性を選択します｡［科目別補助］［資金繰科目］［c/f科目］は変更できません｡［数字］｢1｣を入力すると､右寄せで｢1｣と表示されます｡［数字（前ｾﾞﾛあり）］設定した［桁数］になるように､数字の前に0（ｾﾞﾛ）がついて表示されます｡たとえば､［桁数］が3のときに｢1｣を入力すると､右寄せで｢001｣と表示されます｡［ﾌﾘｰ］半角ｶﾀｶﾅ､半角数字､半角ｱﾙﾌｧﾍﾞｯﾄ（大文字・小文字）､記号を利用できます｡記号は､『会社基本情報登録』の［ﾌﾘｰｺｰﾄﾞに使用する記号］で登録したものが利用できます｡記号の登録方法は次を参照してください｡⇒『［基本情報］ﾀﾌﾞ』参照取引先ﾏｽﾀｰで［ﾌﾘｰ］を選択すると､ﾏｽﾀｰｺｰﾄﾞの自動付番は設定できません｡  一度［ﾌﾘｰ］で登録すると､［数字］または［数字（前ｾﾞﾛあり）］への変更はできません｡予算採用予算管理する場合に､使用する予算を選択します｡予算管理するﾏｽﾀｰにｶｰｿﾙを置いて［予算名称登録］をｸﾘｯｸすると､そのﾏｽﾀｰの予算名称を変更できます｡ここで変更した予算名称は､予算登録や各ﾏｽﾀｰの管理表に反映されます｡予算名称は､14文字以内で入力します｡［資金繰科目］［c/f科目］は､個別の予算名称を登録できます｡そのほかの予算名称は共通です｡ ［分類採用情報］ﾀﾌﾞ任意の分類でﾏｽﾀｰを管理する場合は､分類を採用します｡たとえば､業種別や地域別に､得意先の売上を集計したい場合は､得意先に分類を採用します｡［ﾏｽﾀｰ区分］で管理するﾏｽﾀｰを選択し､［採用区分］から［属性］までを指定して､［更新］をｸﾘｯｸします｡ 採用区分登録する分類を［採用あり］に変更します｡ﾏｽﾀｰ名称登録する分類の名称を20文字以内で入力します｡入力した分類の名称は､『分類登録』の［分類種別］に表示されます｡『分類登録』については､次を参照してください｡⇒『xx分類登録』参照桁数分類ごとに､ｺｰﾄﾞの桁数を入力します｡属性ｺｰﾄﾞの属性を選択します｡［数字］｢1｣を入力すると､右寄せで｢1｣と表示されます｡［数字（前ｾﾞﾛあり）］設定した［桁数］になるように､数字の前に0（ｾﾞﾛ）がついて表示されます｡たとえば､［桁数］が3のときに｢1｣を入力すると､右寄せで｢001｣と表示されます｡［ﾌﾘｰ］半角ｶﾀｶﾅ､半角数字､半角ｱﾙﾌｧﾍﾞｯﾄ（大文字・小文字）､記号を利用できます｡記号は､『会社基本情報登録』の［ﾌﾘｰｺｰﾄﾞに使用する記号］で登録したものが利用できます｡記号の登録方法は次を参照してください｡⇒『［基本情報］ﾀﾌﾞ』参照  一度［ﾌﾘｰ］で登録すると､［数字］または［数字（前ｾﾞﾛあり）］への変更はできません｡ ［ﾏｽﾀｰｺｰﾄﾞ自動付番］ﾀﾌﾞ取引先ｺｰﾄﾞを自動付番する場合に､［取引先自動付番採用区分］を選択し､［ﾏｽﾀｰ採用情報］ﾀﾌﾞで設定した桁数の範囲を入力します｡取引先ﾏｽﾀｰのｺｰﾄﾞ属性が､［数字］または［数字（前ｾﾞﾛあり）］のときに設定できます｡取引先ｺｰﾄﾞが指定した範囲を超えた場合は､取引先の登録ができないため､付番設定を見直す必要があります｡ 取引先自動付番採用区分自動付番する取引先ﾏｽﾀｰの区分を選択します｡［全体］取引先ﾏｽﾀｰの全範囲を指定します｡［得意先／仕入先］ｺｰﾄﾞによって得意先・仕入先を区別する場合に選択します｡［業種］ｺｰﾄﾞによって業種を区別する場合に選択します｡</div></div><div id="CMN11006"><div class="search_breadcrumbs">導入処理 &gt; 導入処理 &gt; 休日を登録する</div><div class="search_title">休日を登録する</div><div class="displayText">休日を登録する　［設定］＞［導入処理］＞［会社情報］＞［休日登録］会社や金融機関などの休日を管理するカレンダーを会社ごとに登録します。 『LucaTech GX』では、土曜・日曜・ ...</div><div class="search_word">休日を登録する　［設定］＞［導入処理］＞［会社情報］＞［休日登録］会社や金融機関などの休日を管理するｶﾚﾝﾀﾞｰを会社ごとに登録します｡ 『lucatech gx』では､土曜・日曜・祝日が休日の｢標準ｶﾚﾝﾀﾞｰ｣を用意しています｡標準ｶﾚﾝﾀﾞｰは当年を含む12年分（過去10年､当年､翌年）が表示されます｡年度更新を行うと､最も古い年度のｶﾚﾝﾀﾞｰは削除され､翌年度分は毎年2月に自動で追加されます｡ 標準ｶﾚﾝﾀﾞｰとは異なる休日を登録する場合は､ｶﾚﾝﾀﾞｰｸﾞﾙｰﾌﾟを作成し､ｸﾞﾙｰﾌﾟごとにｶﾚﾝﾀﾞｰを作成します｡年度更新を行ってもｶﾚﾝﾀﾞｰは自動で追加されないため､新しい年のｶﾚﾝﾀﾞｰを作成する必要があります｡⇒『1.1.2ｶﾚﾝﾀﾞｰを作成する』参照作成したｶﾚﾝﾀﾞｰは､『銀行登録』などで使用します｡</div></div><div id="CMN11007"><div class="search_breadcrumbs">導入処理 &gt; 導入処理 &gt; 休日を登録する &gt; カレンダーグループを作成する</div><div class="search_title">カレンダーグループを作成する</div><div class="displayText">カレンダーグループを作成する年度ごとのカレンダーをまとめて管理するグループを作成し、通年の休日を登録します。カレンダーグループで登録した休日は、同一カレンダーグループ内のすべてのカ ...</div><div class="search_word">ｶﾚﾝﾀﾞｰｸﾞﾙｰﾌﾟを作成する年度ごとのｶﾚﾝﾀﾞｰをまとめて管理するｸﾞﾙｰﾌﾟを作成し､通年の休日を登録します｡ｶﾚﾝﾀﾞｰｸﾞﾙｰﾌﾟで登録した休日は､同一ｶﾚﾝﾀﾞｰｸﾞﾙｰﾌﾟ内のすべてのｶﾚﾝﾀﾞｰに反映されます｡①　［新規ｸﾞﾙｰﾌﾟ追加］をｸﾘｯｸします｡②　［ｺｰﾄﾞ］［ｶﾚﾝﾀﾞｰｸﾞﾙｰﾌﾟ名称］［開始日］を入力し､［追加］をｸﾘｯｸします｡ｺｰﾄﾞｺｰﾄﾞを半角数字4桁で入力します｡ｶﾚﾝﾀﾞｰｸﾞﾙｰﾌﾟ名称ｸﾞﾙｰﾌﾟ名称を20文字以内で入力します｡開始日をｸﾘｯｸして､ｶﾚﾝﾀﾞｰの開始日を指定します｡③　作成したｸﾞﾙｰﾌﾟの［…］で［通年休日設定］をｸﾘｯｸします｡④　［休日一括設定］画面で通年の休日を登録します｡ 曜日毎設定［全て］✔をつけた曜日がすべて休日になります｡［第1週～第6週］第1週から第6週までの特定の曜日を指定します｡［第1～第5］特定の曜日（第1月曜日､第2火曜日など）を指定します｡定休日設定特定の日付を休日にする場合は［新規定休日追加］をｸﾘｯｸしてｶﾚﾝﾀﾞｰから休日とする日を指定します｡ ⑤　［更新］をｸﾘｯｸします｡続けてｶﾚﾝﾀﾞｰを作成します｡⇒『ｶﾚﾝﾀﾞｰを作成する』参照 ｶﾚﾝﾀﾞｰｸﾞﾙｰﾌﾟの名称を編集するｶﾚﾝﾀﾞｰｸﾞﾙｰﾌﾟの名称を変更する場合は､ をｸﾘｯｸします｡標準ｶﾚﾝﾀﾞｰは編集できません｡ ［ｶﾚﾝﾀﾞｰｸﾞﾙｰﾌﾟ名称］を修正し､［更新］をｸﾘｯｸします｡ ｶﾚﾝﾀﾞｰｸﾞﾙｰﾌﾟを削除するｶﾚﾝﾀﾞｰｸﾞﾙｰﾌﾟを削除します｡ｶﾚﾝﾀﾞｰｸﾞﾙｰﾌﾟを削除するには､ｶﾚﾝﾀﾞｰをすべて削除している必要があります｡なお､標準ｶﾚﾝﾀﾞｰは削除できません｡ ［…］の［ｶﾚﾝﾀﾞｰｸﾞﾙｰﾌﾟ削除］をｸﾘｯｸします｡ 次のﾒｯｾｰｼﾞで［削除］をｸﾘｯｸします｡</div></div><div id="CMN11010"><div class="search_breadcrumbs">導入処理 &gt; 導入処理 &gt; 休日を登録する &gt; カレンダーを作成する</div><div class="search_title">カレンダーを作成する</div><div class="displayText">カレンダーを作成する年度ごとにカレンダーを作成します。カレンダーグループで登録した休日はカレンダーに引き継がれますが、その年ごとに休日が異なる場合は、カレンダーに個別に登録します。 ...</div><div class="search_word">ｶﾚﾝﾀﾞｰを作成する年度ごとにｶﾚﾝﾀﾞｰを作成します｡ｶﾚﾝﾀﾞｰｸﾞﾙｰﾌﾟで登録した休日はｶﾚﾝﾀﾞｰに引き継がれますが､その年ごとに休日が異なる場合は､ｶﾚﾝﾀﾞｰに個別に登録します｡①　ｶﾚﾝﾀﾞｰｸﾞﾙｰﾌﾟの［…］で［ｶﾚﾝﾀﾞｰ追加］をｸﾘｯｸします｡②　作成する年度を西暦で入力し､［追加］をｸﾘｯｸします｡次のﾒｯｾｰｼﾞが表示され､ｶﾚﾝﾀﾞｰｸﾞﾙｰﾌﾟにｶﾚﾝﾀﾞｰが追加されます｡③　ｶﾚﾝﾀﾞｰｸﾞﾙｰﾌﾟで設定した休日に変更がある場合は､ｶﾚﾝﾀﾞｰごとに休日を設定します｡ｶﾚﾝﾀﾞｰの［…］で［ｶﾚﾝﾀﾞｰ設定］をｸﾘｯｸします｡④　その年度の休日を設定します｡休日は､ｶﾚﾝﾀﾞｰ上に赤字で表示されます｡［特定の日付を休日にする場合］日付を2回ｸﾘｯｸすると､休日（赤）になります｡再度ｸﾘｯｸすると営業日（黒）に戻ります｡［一年を通して特定の曜日を休日にする場合］［曜日毎設定］で曜日に✔をつけます｡［特定の期間を休日にする場合］［期間設定］で日付を範囲指定します｡⑤　［更新］をｸﾘｯｸします｡ ｶﾚﾝﾀﾞｰを削除するｶﾚﾝﾀﾞｰを削除します｡『銀行登録』や『財務基本情報登録』などでｶﾚﾝﾀﾞｰを使用している場合は､再設定が必要です｡ ［…］の［ｶﾚﾝﾀﾞｰ削除］をｸﾘｯｸします｡ 次のﾒｯｾｰｼﾞで［削除］をｸﾘｯｸします｡</div></div></div>');

var wide = Array("０","１","２","３","４","５","６","７","８","９","Ａ","Ｂ","Ｃ","Ｄ","Ｅ","Ｆ","Ｇ","Ｈ","Ｉ","Ｊ","Ｋ","Ｌ","Ｍ","Ｎ","Ｏ","Ｐ","Ｑ","Ｒ","Ｓ","Ｔ","Ｕ","Ｖ","Ｗ","Ｘ","Ｙ","Ｚ","ａ","ｂ","ｃ","ｄ","ｅ","ｆ","ｇ","ｈ","ｉ","ｊ","ｋ","ｌ","ｍ","ｎ","ｏ","ｐ","ｑ","ｒ","ｓ","ｔ","ｕ","ｖ","ｗ","ｘ","ｙ","ｚ","ガ","ギ","グ","ゲ","ゴ","ザ","ジ","ズ","ゼ","ゾ","ダ","ヂ","ヅ","デ","ド","バ","ビ","ブ","ベ","ボ","パ","ピ","プ","ペ","ポ","。","「","」","、","ヲ","ァ","ィ","ゥ","ェ","ォ","ャ","ュ","ョ","ッ","ー","ア","イ","ウ","エ","オ","カ","キ","ク","ケ","コ","サ","シ","ス","セ","ソ","タ","チ","ツ","テ","ト","ナ","ニ","ヌ","ネ","ノ","ハ","ヒ","フ","ヘ","ホ","マ","ミ","ム","メ","モ","ヤ","ユ","ヨ","ラ","リ","ル","レ","ロ","ワ","ン");
var narrow = Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","ｶﾞ","ｷﾞ","ｸﾞ","ｹﾞ","ｺﾞ","ｻﾞ","ｼﾞ","ｽﾞ","ｾﾞ","ｿﾞ","ﾀﾞ","ﾁﾞ","ﾂﾞ","ﾃﾞ","ﾄﾞ","ﾊﾞ","ﾋﾞ","ﾌﾞ","ﾍﾞ","ﾎﾞ","ﾊﾟ","ﾋﾟ","ﾌﾟ","ﾍﾟ","ﾎﾟ","｡","｢","｣","､","ｦ","ｧ","ｨ","ｩ","ｪ","ｫ","ｬ","ｭ","ｮ","ｯ","ｰ","ｱ","ｲ","ｳ","ｴ","ｵ","ｶ","ｷ","ｸ","ｹ","ｺ","ｻ","ｼ","ｽ","ｾ","ｿ","ﾀ","ﾁ","ﾂ","ﾃ","ﾄ","ﾅ","ﾆ","ﾇ","ﾈ","ﾉ","ﾊ","ﾋ","ﾌ","ﾍ","ﾎ","ﾏ","ﾐ","ﾑ","ﾒ","ﾓ","ﾔ","ﾕ","ﾖ","ﾗ","ﾘ","ﾙ","ﾚ","ﾛ","ﾜ","ﾝ");
var hilight = Array("(?:０|0)","(?:１|1)","(?:２|2)","(?:３|3)","(?:４|4)","(?:５|5)","(?:６|6)","(?:７|7)","(?:８|8)","(?:９|9)","(?:Ａ|A|ａ|a)","(?:Ｂ|B|ｂ|b)","(?:Ｃ|C|ｃ|c)","(?:Ｄ|D|ｄ|d)","(?:Ｅ|E|ｅ|e)","(?:Ｆ|F|ｆ|f)","(?:Ｇ|G|ｇ|g)","(?:Ｈ|H|ｈ|h)","(?:Ｉ|I|ｉ|i)","(?:Ｊ|J|ｊ|j)","(?:Ｋ|K|ｋ|k)","(?:Ｌ|L|ｌ|l)","(?:Ｍ|M|ｍ|m)","(?:Ｎ|N|ｎ|n)","(?:Ｏ|O|ｏ|o)","(?:Ｐ|P|ｐ|p)","(?:Ｑ|Q|ｑ|q)","(?:Ｒ|R|ｒ|r)","(?:Ｓ|S|ｓ|s)","(?:Ｔ|T|ｔ|t)","(?:Ｕ|U|ｕ|u)","(?:Ｖ|V|ｖ|v)","(?:Ｗ|W|ｗ|w)","(?:Ｘ|X|ｘ|x)","(?:Ｙ|Y|ｙ|y)","(?:Ｚ|Z|ｚ|z)","(?:ガ|ｶﾞ)","(?:ギ|ｷﾞ)","(?:グ|ｸﾞ)","(?:ゲ|ｹﾞ)","(?:ゴ|ｺﾞ)","(?:ザ|ｻﾞ)","(?:ジ|ｼﾞ)","(?:ズ|ｽﾞ)","(?:ゼ|ｾﾞ)","(?:ゾ|ｿﾞ)","(?:ダ|ﾀﾞ)","(?:ヂ|ﾁﾞ)","(?:ヅ|ﾂﾞ)","(?:デ|ﾃﾞ)","(?:ド|ﾄﾞ)","(?:バ|ﾊﾞ)","(?:ビ|ﾋﾞ)","(?:ブ|ﾌﾞ)","(?:ベ|ﾍﾞ)","(?:ボ|ﾎﾞ)","(?:パ|ﾊﾟ)","(?:ピ|ﾋﾟ)","(?:プ|ﾌﾟ)","(?:ペ|ﾍﾟ)","(?:ポ|ﾎﾟ)","(?:。|｡)","(?:「|｢)","(?:」|｣)","(?:、|､)","(?:ヲ|ｦ)","(?:ァ|ｧ)","(?:ィ|ｨ)","(?:ゥ|ｩ)","(?:ェ|ｪ)","(?:ォ|ｫ)","(?:ャ|ｬ)","(?:ュ|ｭ)","(?:ョ|ｮ)","(?:ッ|ｯ)","(?:ー|ｰ)","(?:ア|ｱ)","(?:イ|ｲ)","(?:ウ|ｳ)","(?:エ|ｴ)","(?:オ|ｵ)","(?:カ|ｶ)","(?:キ|ｷ)","(?:ク|ｸ)","(?:ケ|ｹ)","(?:コ|ｺ)","(?:サ|ｻ)","(?:シ|ｼ)","(?:ス|ｽ)","(?:セ|ｾ)","(?:ソ|ｿ)","(?:タ|ﾀ)","(?:チ|ﾁ)","(?:ツ|ﾂ)","(?:テ|ﾃ)","(?:ト|ﾄ)","(?:ナ|ﾅ)","(?:ニ|ﾆ)","(?:ヌ|ﾇ)","(?:ネ|ﾈ)","(?:ノ|ﾉ)","(?:ハ|ﾊ)","(?:ヒ|ﾋ)","(?:フ|ﾌ)","(?:ヘ|ﾍ)","(?:ホ|ﾎ)","(?:マ|ﾏ)","(?:ミ|ﾐ)","(?:ム|ﾑ)","(?:メ|ﾒ)","(?:モ|ﾓ)","(?:ヤ|ﾔ)","(?:ユ|ﾕ)","(?:ヨ|ﾖ)","(?:ラ|ﾗ)","(?:リ|ﾘ)","(?:ル|ﾙ)","(?:レ|ﾚ)","(?:ロ|ﾛ)","(?:ワ|ﾜ)","(?:ン|ﾝ)");

// Global variables for MutationObserver feature
var currentSearchValue = ""; // Current search keyword
var mutationObserver = null; // MutationObserver instance
var debounceTimer = null; // Debounce timer for DOM changes

function selectorEscape(val){
  return val.replace(/[-\/\\^$*+?.()|[\]{}\!]/g, '\\$&');
}

// Apply highlight to iframe content
function applyHighlight(searchValue) {
  var searchWordTmp = searchValue.split("　").join(" ").trim();
  searchWordTmp = searchWordTmp.split("  ").join(" ");
  for(var i = 0; i < wide.length; i++) {
    searchWordTmp = searchWordTmp.replace(wide[i], narrow[i]);
  }
  var searchWord = searchWordTmp.split(" ");
  for(var i = 0; i < searchWord.length; i++) {
    searchWord[i] = selectorEscape(searchWord[i].replace(">", "&gt;").replace("<", "&lt;"));
  }
  var hilightWord = searchWord.join("|");
  for(var i = 0; i < hilight.length; i++) {
    var reg = new RegExp(hilight[i], "gm");
    hilightWord = hilightWord.replace(reg, hilight[i]);
  }

  var reg = new RegExp("("+hilightWord+")(?=[^<>]*<)", "gm");
  var regnbsp = new RegExp("&nbsp;(?=[^<>]*<)", "gm");
  var reggt = new RegExp("&gt;(?=[^<>]*<)", "gm");
  var reglt = new RegExp("&lt;(?=[^<>]*<)", "gm");
  var regquot = new RegExp("&quot;(?=[^<>]*<)", "gm");
  var regamp = new RegExp("&amp;(?=[^<>]*<)", "gm");
  $("iframe.topic").contents().find("body").html($("iframe.topic").contents().find("body").html().replace(regnbsp, "　").replace(reggt, ">").replace(reglt, "<").replace(regquot, '"').replace(regamp, "&").replace(reg, "<font class='keyword' style='color:rgb(0, 0, 0); background-color:rgb(252, 255, 0);'>$1</font>"));
}

// Remove keyword highlights
function removeHighlight() {
  $("iframe.topic").contents().find(".keyword").each(function() {
    for(var i = 0; i < $(this)[0].childNodes.length; i++) {
      this.parentNode.insertBefore($(this)[0].childNodes[i], this);
    }
    $(this).remove();
  });
}

// Setup MutationObserver for iframe content
function setupMutationObserver() {
  disconnectMutationObserver();
  
  try {
    var $iframe = $("iframe.topic");
    if ($iframe.length === 0) return;
    
    var iframeDocument = $iframe[0].contentDocument || $iframe[0].contentWindow.document;
    if (!iframeDocument || !iframeDocument.body) return;
    
    mutationObserver = new MutationObserver(function(mutations) {
      if (!currentSearchValue || currentSearchValue.trim() === "") {
        return;
      }
      
      var shouldReHighlight = false;
      for (var i = 0; i < mutations.length; i++) {
        var mutation = mutations[i];
        if (mutation.type === 'childList') {
          var addedKeywords = false;
          for (var j = 0; j < mutation.addedNodes.length; j++) {
            var node = mutation.addedNodes[j];
            if (node.nodeType === Node.ELEMENT_NODE) {
              if (node.classList && node.classList.contains('keyword')) {
                addedKeywords = true;
                break;
              }
              if (node.querySelector && node.querySelector('.keyword')) {
                addedKeywords = true;
                break;
              }
            }
          }
          
          if (addedKeywords && mutation.addedNodes.length === 1) {
            continue;
          }
          
          if (mutation.addedNodes.length > 0 || mutation.removedNodes.length > 0) {
            shouldReHighlight = true;
            break;
          }
        } else if (mutation.type === 'characterData') {
          shouldReHighlight = true;
          break;
        }
      }
      
      if (shouldReHighlight) {
        debouncedReHighlight();
      }
    });
    
    mutationObserver.observe(iframeDocument.body, {
      childList: true,
      subtree: true,
      characterData: true,
      attributes: false
    });
    
    console.debug("MutationObserver setup for iframe content");
  } catch (error) {
    console.warn("Failed to setup MutationObserver:", error);
  }
}

// Debounced re-highlighting
function debouncedReHighlight() {
  if (debounceTimer) {
    clearTimeout(debounceTimer);
  }
  
  debounceTimer = setTimeout(function() {
    reHighlightAfterDomChange();
  }, 500);
}

// Re-highlight after DOM change
function reHighlightAfterDomChange() {
  if (!currentSearchValue || currentSearchValue.trim() === "") {
    return;
  }
  
  try {
    disconnectMutationObserver();
    removeHighlight();
    applyHighlight(currentSearchValue);
    
    setTimeout(function() {
      setupMutationObserver();
    }, 100);
    
    console.debug("Re-highlighted search terms after DOM change");
  } catch (error) {
    console.warn("Failed to re-highlight after DOM change:", error);
    setupMutationObserver();
  }
}

// Disconnect MutationObserver
function disconnectMutationObserver() {
  if (mutationObserver) {
    mutationObserver.disconnect();
    mutationObserver = null;
  }
  
  if (debounceTimer) {
    clearTimeout(debounceTimer);
    debounceTimer = null;
  }
}

$(function(){
  $(document).on("click", "ul.toc li.book", function() {
    if($(this).children("a[href='#'],a[href='javascript:void 0;']").length == 0)
    {
      $(this).children("a").each(function(){
        location.href=location.href.replace(location.hash,"")+"#t="+$(this).attr("href");
      });
    }
  });
  $(".wSearchField").each(function() {
    $(this).off();
  });
  $(document).on("keyup", ".wSearchField", function(){
    if($(this).val() == "")
    {
      $(".wSearchResultItemsBlock").html("");
      $(".wSearchResultsEnd").addClass("rh-hide");
      $(".wSearchResultsEnd").attr("hidden", "");
      $("#searchMsg").html("2つ以上の語句を入力して検索する場合は、スペース（空白）で区切ります。");
      removeHighlight();
      currentSearchValue = ""; // Clear current search value
      disconnectMutationObserver(); // Disconnect observer when clearing
    }
    else
    {
      $("#searchMsg").html("");
      currentSearchValue = $(this).val(); // Store current search value
      var searchWordTmp = $(this).val().replace(/(.*?)(?:　| )+(.*?)/g, "$1 $2").trim().toLowerCase();
      for(i = 0; i < wide.length; i ++)
      {
        searchWordTmp = searchWordTmp.split(wide[i]).join(narrow[i]);
      }
      var searchWord = searchWordTmp.split(" ");
      var searchQuery = "";
      for(i = 0; i < searchWord.length; i ++)
      {
        searchQuery += ":contains(" + searchWord[i] + ")";
      }
      
      var findItems = searchWords.find(".search_word"+searchQuery);
      if(findItems.length != 0)
      {
        $(".wSearchResultsEnd").removeClass("rh-hide");
        $(".wSearchResultsEnd").removeAttr("hidden");
        $(".wSearchResultItemsBlock").html("");
        findItems.each(function() {
          var displayText = $(this).parent().find(".displayText").text();
          $(".wSearchResultItemsBlock").append($("<div class='wSearchResultItem'><a class='nolink' href='./"+$(this).parent().attr("id")+".html'><div class='wSearchResultTitle'>"+$(this).parent().find(".search_title").html()+"</div></a><div class='wSearchContent'><span class='wSearchContext'>"+displayText+"</span></div></div>"));
        });
        removeHighlight();
        applyHighlight(currentSearchValue);
      }
      else
      {
        removeHighlight();
        $(".wSearchResultsEnd").addClass("rh-hide");
        $(".wSearchResultsEnd").attr("hidden", "");
        $(".wSearchResultItemsBlock").html("");
        displayText = "検索条件に一致するトピックはありません。";
        $(".wSearchResultItemsBlock").append($("<div class='wSearchResultItem'><div class='wSearchContent'><span class='wSearchContext'>"+displayText+"</span></div></div>"));
      }
    }
  });
  $("iframe.topic").on("load", function(){
    if($(".search-input", document).is(":not(.rh-hide)") && ($(".wSearchField", document).val() != ""))
    {
      var searchValue = $(".wSearchField", document).val();
      currentSearchValue = searchValue; // Store current search value
      applyHighlight(searchValue);
    }
    
    // Setup MutationObserver for iframe content changes
    setupMutationObserver();
  });
});
